<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>RAPR User's and Reference Guide</title><link rel="stylesheet" type="text/css" href="html.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><meta name="description" content="The Real-time Application Representative (RAPR) is open source software developed by the Naval Research Laboratory (NRL) PROtocol Engineernig Advanced Networking (PROTEAN) group and was designed to emulate generic application performance on IP networks using both UDP and TCP transport mechanisms. RAPR can generate and respond to real-time network traffic in a manner closely tied to application behavior so that the network can be loaded in a variety of ways in a controlled and repeatable manner. It uses the Mgen toolkit (MGEN) to generate network traffic and supports most of the traffic shaping functionality available in Mgen Version 5.0. The network traffic can be logged for subsequent analysis and can be used to calculate performance statistics on throughput, packet loss rates, communication delay, and more."></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article"><div class="titlepage"><div><div><h2 class="title"><a name="d0e2"></a><span class="inlinemediaobject"><img src="resources/raprLogo.gif"></span><span class="inlinemediaobject"><img src="resources/mgenLogo.gif"></span>RAPR User's and Reference Guide</h2></div><div><div class="abstract"><p class="title"><b>Abstract</b></p><p>The <a class="ulink" href="http://www.nrl.navy.mil/itd/ncs/products/rapr" target="_top">Real-time Application Representative (RAPR)</a> is open source software developed by the <a class="ulink" href="http://www.nrl.navy.mil/" target="_top">Naval Research Laboratory (NRL)</a> PROtocol Engineernig Advanced Networking (PROTEAN) group and was designed to emulate generic application performance on IP networks using both UDP and TCP transport mechanisms. RAPR can generate and respond to real-time network traffic in a manner closely tied to application behavior so that the network can be loaded in a variety of ways in a controlled and repeatable manner. It uses the Mgen toolkit (MGEN) to generate network traffic and supports most of the traffic shaping functionality available in Mgen Version 5.0. The network traffic can be logged for subsequent analysis and can be used to calculate performance statistics on throughput, packet loss rates, communication delay, and more.</p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#d0e23">1. Introduction</a></span></dt><dt><span class="sect1"><a href="#Quick_Link">2. Quick Links</a></span></dt><dt><span class="sect1"><a href="#_sample_application">3. Sample Application</a></span></dt><dd><dl><dt><span class="sect2"><a href="#_web_server">3.1. Web Server</a></span></dt><dd><dl><dt><span class="sect3"><a href="#Example_Web_Server_Input_Script">3.1.1. Example Web Server Input Script</a></span></dt><dt><span class="sect3"><a href="#Example_Web_Server_Logictable">3.1.2. Example Web Client Input Script</a></span></dt><dt><span class="sect3"><a href="#Example_Web_Server_Logictable">3.1.3. Example Web Server Dictionary</a></span></dt><dt><span class="sect3"><a href="#Example_Web_Server_Log_File">3.1.4. Example Web Server Logic Table</a></span></dt><dt><span class="sect3"><a href="#Example_Web_Server_Log_File">3.1.5. Plot of Web Server Application Behavior</a></span></dt></dl></dd><dt><span class="sect2"><a href="#d0e256">3.2.  Application Best Practices</a></span></dt><dd><dl><dt><span class="sect3"><a href="#d0e261">3.2.1. Set a HOSTID or INITIAL_SEED</a></span></dt><dt><span class="sect3"><a href="#d0e273">3.2.2. Use a default input script.</a></span></dt><dt><span class="sect3"><a href="#d0e280">3.2.3. Use a default dictionary</a></span></dt><dt><span class="sect3"><a href="#d0e287">3.2.4. Define a default directory structure</a></span></dt><dt><span class="sect3"><a href="#d0e297">3.2.5. Default port ranges</a></span></dt></dl></dd></dl></dd><dt><span class="sect1"><a href="#d0e302">4. Host ID, Initial Seed, &amp; Repeatability</a></span></dt><dt><span class="sect1"><a href="#d0e346">5. Unique Behavior Identifier (UBI)</a></span></dt><dt><span class="sect1"><a href="#d0e368">6. Script synchronization.</a></span></dt><dt><span class="sect1"><a href="#d0e377">7. RAPR System Defaults</a></span></dt><dt><span class="sect1"><a href="#_RAPR_Usage:">8. RAPR Usage</a></span></dt><dd><dl><dt><span class="sect2"><a href="#Command-line_Options">8.1. Command-line Options</a></span></dt><dt><span class="sect2"><a href="#d0e628">8.2. Upper and Lower case support</a></span></dt><dt><span class="sect2"><a href="#d0e635">8.3. Shorthand</a></span></dt><dt><span class="sect2"><a href="#Example_Usage">8.4. Example Usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="#_RAPR_run-time_interface">9. Run-Time Interface</a></span></dt><dt><span class="sect1"><a href="#_behavior_table">10. Behavior Event Table</a></span></dt><dd><dl><dt><span class="sect2"><a href="#_state">10.1. &lt;state&gt;</a></span></dt><dt><span class="sect2"><a href="#_logicid">10.2. &lt;logicid&gt;</a></span></dt><dt><span class="sect2"><a href="#_percent">10.3. &lt;percent&gt;</a></span></dt><dt><span class="sect2"><a href="#_entry">10.4. &lt;entry&gt;</a></span></dt><dt><span class="sect2"><a href="#_word_replacement">10.5. Word Replacement in the Behavior Table</a></span></dt><dt><span class="sect2"><a href="#_namespace">10.6. Name Spaces in the Behavior Table</a></span></dt><dt><span class="sect2"><a href="#_ubi_state">10.7. UBI State in the Behavior Table</a></span></dt></dl></dd><dt><span class="sect1"><a href="#_dictionary">11. Dictionary</a></span></dt><dd><dl><dt><span class="sect2"><a href="#_dictionary-namespace">11.1. Namespace in the Dictionary</a></span></dt><dt><span class="sect2"><a href="#_field">11.2. Field</a></span></dt><dt><span class="sect2"><a href="#_value">11.3. Value</a></span></dt><dt><span class="sect2"><a href="#_hostid">11.4. HOSTID Keyword</a></span></dt><dt><span class="sect2"><a href="#Nested_dictionary_translations">11.5. Nested dictionary translations</a></span></dt><dt><span class="sect2"><a href="#_reserved_namespaces">11.6. Reserved Namespaces</a></span></dt><dt><span class="sect2"><a href="#d0e975">11.7. Default Dictionary and Default System Values</a></span></dt></dl></dd><dt><span class="sect1"><a href="#_input_script">12. RAPR Input Script Format</a></span></dt><dt><span class="sect1"><a href="#_Behavior_events">13. Behavior Events</a></span></dt><dd><dl><dt><span class="sect2"><a href="#_declarative">13.1. Declarative Event</a></span></dt><dd><dl><dt><span class="sect3"><a href="#d0e1101">13.1.1. STOP, DURATION, and COUNT attributes.</a></span></dt><dt><span class="sect3"><a href="#d0e1115">13.1.2. Infinite data flows.</a></span></dt><dt><span class="sect3"><a href="#d0e1120">13.1.3. RAPRFLOWID</a></span></dt><dt><span class="sect3"><a href="#d0e1128">13.1.4. SRC, DST, and PATTERN attributes</a></span></dt><dt><span class="sect3"><a href="#d0e1147">13.1.5. LOGICID, SUCCESS, FAILURE, TIMEOUT, PAYLOAD.</a></span></dt><dt><span class="sect3"><a href="#d0e1159">13.1.6. Examples</a></span></dt></dl></dd><dt><span class="sect2"><a href="#_interrogative">13.2. Interrogative Event</a></span></dt><dd><dl><dt><span class="sect3"><a href="#d0e1208">13.2.1. RETRYINTERVAL and NUMRETRIES</a></span></dt><dt><span class="sect3"><a href="#d0e1213">13.2.2. Stream Duration and COUNT</a></span></dt><dt><span class="sect3"><a href="#d0e1223">13.2.3. Logic Id's</a></span></dt><dt><span class="sect3"><a href="#d0e1234">13.2.4. Examples</a></span></dt></dl></dd><dt><span class="sect2"><a href="#_stream">13.3. Stream Event</a></span></dt><dd><dl><dt><span class="sect3"><a href="#_RESPPROB">13.3.1. RESPPROB</a></span></dt><dt><span class="sect3"><a href="#_BURSTDURATION">13.3.2. BURSTDURATION</a></span></dt><dt><span class="sect3"><a href="#_BURSTCOUNT">13.3.3. BURSTCOUNT</a></span></dt><dt><span class="sect3"><a href="#_BURSTDELAY">13.3.4. BURSTDELAY</a></span></dt><dt><span class="sect3"><a href="#_BURSTRANGE">13.3.5. BURSTRANGE</a></span></dt><dt><span class="sect3"><a href="#_TIMEOUTINTERVAL">13.3.6. TIMEOUTINTERVAL</a></span></dt><dt><span class="sect3"><a href="#_BURSTPRIORITY">13.3.7. BURSTPRIORITY</a></span></dt></dl></dd><dt><span class="sect2"><a href="#_periodic">13.4. Periodic Event</a></span></dt><dd><dl><dt><span class="sect3"><a href="#_INTERVAL">13.4.1. INTERVAL</a></span></dt><dt><span class="sect3"><a href="#d0e1416">13.4.2. EXP</a></span></dt><dt><span class="sect3"><a href="#_DURATION">13.4.3. DURATION</a></span></dt><dt><span class="sect3"><a href="#_description">13.4.4. Declarative/Interrogative Description</a></span></dt></dl></dd><dt><span class="sect2"><a href="#_Behavior_Event_Options">13.5. Behavior Event Options</a></span></dt><dd><dl><dt><span class="sect3"><a href="#Protocol__UDP">13.5.1. Protocol (UDP)</a></span></dt><dt><span class="sect3"><a href="#_Destination__DST">13.5.2. Destination (DST)</a></span></dt><dt><span class="sect3"><a href="#_Source_Port__SRC">13.5.3. Source Port (SRC)</a></span></dt><dt><span class="sect3"><a href="#Pattern__PERIODIC,_POISSON,_BURST">13.5.4. Pattern (PERIODIC, POISSON, BURST)</a></span></dt><dt><span class="sect3"><a href="#_Destination__DST">13.5.5. Count</a></span></dt><dt><span class="sect3"><a href="#Type-Of-Service__TOS">13.5.6. Type-Of-Service (TOS)</a></span></dt><dt><span class="sect3"><a href="#_Time-To-Live__TTL">13.5.7. Multicast Time-To-Live (TTL)</a></span></dt><dt><span class="sect3"><a href="#_TXBUFFER">13.5.8. Socket Transmit Buffer Size (TXBUFFER)</a></span></dt><dt><span class="sect3"><a href="#Socket_Receive_Buffer_Size__RXBUFFER">13.5.9. Socket Receive Buffer Size (RXBUFFER)</a></span></dt><dt><span class="sect3"><a href="#Multicast_Interface__INTERFACE">13.5.10. Multicast Interface (INTERFACE)</a></span></dt></dl></dd><dt><span class="sect2"><a href="#_Reception_Event">13.6. Reception Events</a></span></dt><dd><dl><dt><span class="sect3"><a href="#_LISTEN">13.6.1. LISTEN</a></span></dt><dt><span class="sect3"><a href="#_JOIN">13.6.2. JOIN</a></span></dt></dl></dd></dl></dd><dt><span class="sect1"><a href="#_Rapr_Events">14. Rapr Events and Global Commands</a></span></dt><dd><dl><dt><span class="sect2"><a href="#_RAPR_EVENT">14.1. RaprEvents</a></span></dt><dd><dl><dt><span class="sect3"><a href="#_raprflowid">14.1.1. RAPRFLOWID</a></span></dt><dt><span class="sect3"><a href="#_dictionary_entry">14.1.2. DICTIONARY_ENTRY</a></span></dt><dt><span class="sect3"><a href="#_logictable_file">14.1.3. LOGICTABLE_FILE</a></span></dt><dt><span class="sect3"><a href="#_dictionary_file">14.1.4. DICTIONARY_FILE</a></span></dt><dt><span class="sect3"><a href="#_CHANGE_STATE">14.1.5. CHANGE_STATE</a></span></dt><dt><span class="sect3"><a href="#_change_ubi_state">14.1.6. CHANGE_UBI_STATE</a></span></dt><dt><span class="sect3"><a href="#_logicid">14.1.7. LOGICID</a></span></dt><dt><span class="sect3"><a href="#_input">14.1.8. INPUT</a></span></dt><dt><span class="sect3"><a href="#_raprpipe">14.1.9. RAPRPIPE</a></span></dt><dt><span class="sect3"><a href="#_stop">14.1.10. STOP</a></span></dt><dt><span class="sect3"><a href="#_clear">14.1.11. CLEAR</a></span></dt></dl></dd><dt><span class="sect2"><a href="#_GLOBAL">14.2. Global Commands</a></span></dt><dd><dl><dt><span class="sect3"><a href="#_hostid">14.2.1. HOSTID</a></span></dt><dt><span class="sect3"><a href="#_hostid">14.2.2. INITIAL_SEED</a></span></dt><dt><span class="sect3"><a href="#_START">14.2.3. START</a></span></dt><dt><span class="sect3"><a href="#_OFFSET">14.2.4. OFFSET</a></span></dt><dt><span class="sect3"><a href="#_TOS">14.2.5. TOS</a></span></dt><dt><span class="sect3"><a href="#_LABEL">14.2.6. LABEL</a></span></dt><dt><span class="sect3"><a href="#_TTL">14.2.7. TTL</a></span></dt><dt><span class="sect3"><a href="#TXBUFFER">14.2.8. TXBUFFER</a></span></dt><dt><span class="sect3"><a href="#RXBUFFER">14.2.9. RXBUFFER</a></span></dt><dt><span class="sect3"><a href="#_INTERFACE">14.2.10. INTERFACE</a></span></dt><dt><span class="sect3"><a href="#_INPUT">14.2.11. INPUT</a></span></dt><dt><span class="sect3"><a href="#_OVERWRITE_RAPRLOG">14.2.12. OVERWRITE_RAPRLOG</a></span></dt><dt><span class="sect3"><a href="#_OVERWRITE_MGENLOG">14.2.13. OVERWRITE_MGENLOG</a></span></dt><dt><span class="sect3"><a href="#_RAPRLOG">14.2.14. RAPRLOG</a></span></dt><dt><span class="sect3"><a href="#MGENLOG">14.2.15. MGENLOG</a></span></dt></dl></dd></dl></dd><dt><span class="sect1"><a href="#_RAPR_Log_File">15. RAPR Log File Format</a></span></dt><dd><dl><dt><span class="sect2"><a href="#General_RAPR_Log_Format">15.1. General RAPR Log Format</a></span></dt></dl></dd><dt><span class="sect1"><a href="#_MGEN_Log_File">16. MGEN Log File Format</a></span></dt><dd><dl><dt><span class="sect2"><a href="#General_Log_Format">16.1. General Log Format</a></span></dt><dt><span class="sect2"><a href="#_Log_File_RECV">16.2. Log File RECV Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_RERR">16.3. Log File RERR Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_SEND_Events">16.4. Log File SEND Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_JOIN">16.5. Log File JOIN Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_LEAVE">16.6. Log File LEAVE Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_LISTEN">16.7. Log File LISTEN Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_IGNORE">16.8. Log File IGNORE Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_ON">16.9. Log File ON Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_CONNECT">16.10. Log File CONNECT Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_DISCONNECTED">16.11. Log File DISCONNECTED Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_OFF">16.12. Log File OFF Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_Start_Stop">16.13. Log File START and STOP Events</a></span></dt></dl></dd><dt><span class="sect1"><a href="#_Binary">17. Binary Log File Format</a></span></dt><dd><dl><dt><span class="sect2"><a href="#_Binary_Log_File_RECV_Events">17.1. Binary Log File RECV Events</a></span></dt><dt><span class="sect2"><a href="#Binary_Log_File_RERR_Event">17.2. Binary Log File RERR Events</a></span></dt><dt><span class="sect2"><a href="#Binary_Log_File_SEND_Events">17.3. Binary Log File SEND Events</a></span></dt><dt><span class="sect2"><a href="#Binary_Log_File_LISTEN_IGNORE_Events">17.4. Binary Log File LISTEN/IGNORE Events</a></span></dt><dt><span class="sect2"><a href="#Binary_Log_File_JOIN_LEAVE_Events">17.5. Binary Log File JOIN/LEAVE Events</a></span></dt><dt><span class="sect2"><a href="#Binary_Log_File_START_STOP_Events">17.6. Binary Log File START/STOP Events</a></span></dt></dl></dd><dt><span class="sect1"><a href="#_RAPR_Message_Payload_">18. RAPR Message Payload</a></span></dt><dt><span class="sect1"><a href="#d0e3019">19. Known Bugs and Issues</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e3022">19.1. Offset and the Periodic Object</a></span></dt><dt><span class="sect2"><a href="#d0e3027">19.2. POISSON (Exponential) MGEN Patterns and Repeatability</a></span></dt><dt><span class="sect2"><a href="#d0e3032">19.3. RAPR and SMF</a></span></dt><dt><span class="sect2"><a href="#d0e3039">19.4. Path Specification </a></span></dt><dt><span class="sect2"><a href="#d0e3044">19.5. Stream Behavior Events and Network Volatility</a></span></dt></dl></dd></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e23"></a>1.&nbsp;Introduction</h2></div></div></div><p>The Real-time Application Representative (RAPR) is open source software developed by the <a class="ulink" href="http://www.nrl.navy.mil/" target="_top">Naval Research Laboratory</a> (NRL) PROTocol Engineering Advanced Networking (PROTEAN) group and was designed to emulate generic application performance on IP networks using both UDP and TCP transport mechanisms.</p><p>RAPR can generate and respond to real-time network traffic in a manner closely tied to application behavior so that the network can be loaded in a variety of ways in a controlled and repeatable manner. It uses the Mgen toolkit (<a class="ulink" href="http://www.nrl.navy.mil/itd/ncs/products/mgen" target="_top">MGEN</a>) to generate network traffic and supports most of the traffic shaping functionality available in Mgen Version 5.0. The network traffic can be logged for subsequent analysis and can be used to calculate performance statistics on throughput, packet loss rates, communication delay, and more.</p><p>RAPR behavior is defined by a <a class="link" href="#_input_script" title="12.&nbsp;RAPR Input Script Format">RAPR input script</a>, a <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a>, and <a class="link" href="#_RAPR_run-time_interface" title="9.&nbsp;Run-Time Interface">RAPR run-time interface</a> to handle RAPR commands over a run-time interface. The <a class="link" href="#_input_script" title="12.&nbsp;RAPR Input Script Format">RAPR input script</a> is used to schedule emulated application behavior over a time line. The <a class="link" href="#_RAPR_run-time_interface" title="9.&nbsp;Run-Time Interface">RAPR run-time interface</a> can be used to inject and schedule additional RAPR behaviors. The <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a> defines behavior in response to network or application generated events. Additionally a <a class="link" href="#_dictionary" title="11.&nbsp;Dictionary">dictionary</a> can be used to translate name-value pairs used by the application and scripts.</p><p>RAPR behavior events fall into three categories: <a class="link" href="#">Reception Events</a> which direct RAPR to listen for specific network traffic, <a class="link" href="#_Rapr_Events" title="14.&nbsp;Rapr Events and Global Commands">RAPR Events</a> which direct the application itself (to load a <a class="link" href="#_dictionary" title="11.&nbsp;Dictionary">dictionary</a> for example), and <a class="link" href="#">Behavior Events</a> which direct RAPR to emulate generic application behavior.</p><p><a class="link" href="#">Behavior Events</a> are rather elementary and mainly are responsible for initiating network traffic. The set of behavior events include:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="link" href="#_declarative" title="13.1.&nbsp;Declarative Event">Declarative</a> Events which send TCP or UDP (unicast or multicast) traffic to a destination address and complete. </li><li class="listitem"><a class="link" href="#_interrogative" title="13.2.&nbsp;Interrogative Event">Interrogative</a> Events which send TCP or UDP (unicast or multicast) traffic to a destination address and then wait for a response. If a response is not received within a specified time period, the Interrogative Event will resend the message. </li><li class="listitem"><a class="link" href="#_stream" title="13.3.&nbsp;Stream Event">Stream</a> Events which send UDP multicast traffic and wait for and react to responses from other nodes listening to the multicast address. Stream events are currently designed to facilitate Voice over IP traffic patterns and emulate "conversations". </li><li class="listitem"><a class="link" href="#_periodic" title="13.4.&nbsp;Periodic Event">Periodic</a> Events can be used to spawn other behavior event types (Declarative and Interrogative only) at regular intervals. These generated behavior events behave as independent events and have no relationship to one another. </li></ul></div><p>It is the interaction between the generated network traffic initiated by these <a class="link" href="#">Behavior Events</a> types and a target node(s) response as defined in its <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a>that together emulate network enabled application behavior. Generated traffic can be associated with a payload logic id that is used to direct the target node(s) response. The incoming payload logic id is then used to lookup any action to be taken in the receiving node's <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a> (e.g. respond with a declarative message, start a stream event object, etc.).</p><p>The principle tool is the RAPR program which can generate, receive, and log test traffic. This document provides information on RAPR usage, message payload, script, table, and log file formats. Additional tools are available to facilitate automated script file creation and log file analyses.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quick_Link"></a>2.&nbsp;Quick Links</h2></div></div></div><p><a class="ulink" href="http://pf.itd.nrl.navy.mil/rapr/rapr-tutorial.html" target="_top">RAPR Tutorial</a></p><p><a class="link" href="#_sample_application" title="3.&nbsp;Sample Application">Sample Application</a></p><p><a class="link" href="#_RAPR_Usage:" title="8.&nbsp;RAPR Usage">RAPR Usage</a></p><p><a class="link" href="#_input_script" title="12.&nbsp;RAPR Input Script Format">RAPR Input Script</a></p><p><a class="link" href="#">Behavior Events</a></p><p><a class="link" href="#">Reception Events</a></p><p><a class="link" href="#_Rapr_Events" title="14.&nbsp;Rapr Events and Global Commands">RAPR Events</a></p><p><a class="link" href="#_GLOBAL" title="14.2.&nbsp;Global Commands">Global Commands</a></p><p><a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">RAPR Behavior Table</a></p><p><a class="link" href="#_RAPR_run-time_interface" title="9.&nbsp;Run-Time Interface">RAPR Run-time Interface</a></p><p><a class="link" href="#_dictionary" title="11.&nbsp;Dictionary">RAPR Dictionary</a></p><p><a class="link" href="#_RAPR_Log_File" title="15.&nbsp;RAPR Log File Format">RAPR Log File Format</a></p><p><a class="link" href="#_MGEN_Log_File" title="16.&nbsp;MGEN Log File Format">MGEN Log File Format</a></p><p><a class="link" href="#">RAPR Message Payload</a></p><p><a class="ulink" href="http://www.nrl.navy.mil/itd/ncs/products/protean_tools" target="_top">gpsLogger GPS Utility</a></p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_sample_application"></a>3.&nbsp;Sample Application</h2></div></div></div><p>The following example shows how to set up a <span class="emphasis"><em>simple</em></span> web server application with one node acting as the <a class="link" href="#_web_server" title="3.1.&nbsp;Web Server">web server</a> and another node acting as a <a class="link" href="#">web client</a>.</p><p>The web server is modeled to be a simple stateless server that simply responds to various client requests. The web client drives the behavior by sending logic ids to the server that trigger its response, for example to return an "HTML web page". The traffic patterns are randomized such that the emulated behavior reflects the randomness of real traffic patterns but is repeatable.</p><p>The sample application models two behavior "patterns":</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"> The client requests an HTML web page. After the server returns a "web page", the client requests between one and three gif files. </li><li class="listitem"> The client requests an HTML web page with a link to a file. The server responds with a file between 512 and 38192 bytes. </li></ul></div><p>The steps in the sample application that model the client requesting an HTML web page are detailed below:</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The examples below will work if run co-located with the rapr binary. They are also included in the rapr distribution with a few minor changes as discussed in the distribution.</p></div><p>STEP 1 The client's input script initiates the "application" behavior by directing the client to send a single mgen message between 76 and 2048 bytes with a logic ID "1" to the server to emulate "requesting an html page". A PERIODIC object is used to repeat the behavior every 15 to 30 seconds for six minutes:</p><pre class="programlisting"># Send a request every 15 to 30 seconds 
DURATION 360 PERIODIC INTERVAL %SYSTEM:RANDOMI(15,30)% DECLARATIVE TCP 
DST %SERVER:IP%/%HTTP_SERVER_PORT% PERIODIC [1 %SYSTEM:RANDOMI(76,2048)%] LOGICID 1 COUNT 1</pre><p>STEP 2 The Server's behavior table directs it to return a TCP message between 76 and 2048 bytes to the sender of the triggering packet (%PACKET:SRCIP%) with a logic id of "2" in order to emulate "returning an html page":</p><pre class="programlisting">   &lt;logicid&gt;
      &lt;!-- Logic id 1 initiates the interaction between the client
           and the server.  It is sent from the client to the server 
           and directs the server to send a single TCP packet
           or "web page" of random size with logic id 2 
           back to the client --&gt;
      &lt;id&gt;1&lt;/id&gt;
      &lt;entry&gt;DECLARATIVE TCP DST %PACKET:SRCIP%/%HTTP_CLIENT_PORT% 
             PERIODIC [1 %SYSTEM:RANDOMI(76,2048)%] COUNT 1 LOGICID 2&lt;/entry&gt;
    &lt;/logicid&gt;</pre><p>STEP 3 Logic ID 2 in the client's behavior table causes it to send one to three more requests to the server (the originator of the packet referenced by %PACKET:SRCIP%), immediately upon receipt of the triggering packet with logic id 3. Note that the client has a 50 percent probability of making this second request:</p><pre class="programlisting">     &lt;logicid&gt;
      &lt;!-- Logic id 2 is sent from the server to the client.
           It directs the client to send between 1 and 3
           TCP messages (or "requests for gif files") back to 
           the server.  These mesages(s) are associated with logic
           id 3. Note that the client has a 50% probability
           of making these requests. --&gt;
      &lt;id&gt;2&lt;/id&gt;
      &lt;percent&gt;0.5&lt;/percent&gt;
      &lt;entry&gt;DECLARATIVE TCP DST %PACKET:SRCIP%/%HTTP_SERVER_PORT% 
             POISSON [1 %SYSTEM:RANDOMI(76,2048)%] LOGICID 3 COUNT 
             %SYSTEM:RANDOMI(1,3)%&lt;/entry&gt;
    &lt;/logicid&gt;</pre><p>STEP 4 The server then, immediately upon receipt of each message containing logic id 3, returns a tcp message between 512 and 38192 bytes to the client to emulate "sending a file":</p><pre class="programlisting">    &lt;logicid&gt;
      &lt;id&gt;3&lt;/id&gt;
      &lt;!-- Logic if 3 is sent from the client to the server.
           It directs the server to send a single TCP message (or "file")
           between 512 and 38192 bytes back to the client.  It is
           not associated with a logic id and "ends" the 
           interaction initiated by logic id 1. The server will
           respond between 1 and 3 times depending on how many 
           "http requests" (or packets associated with logic id 3
           it received from the client.--&gt;
      &lt;entry&gt;DECLARATIVE TCP DST %PACKET:SRCIP%/%HTTP_CLIENT_PORT% 
             POISSON [1 %SYSTEM:RANDOMI(512,38192)%] COUNT 1&lt;/entry&gt;
    &lt;/logicid&gt;</pre><p>The server did not include a logic id in the payload directing the client to perform any further behavior so the traffic pattern ends.</p><p>Note that the server is "shutdown" 120 seconds into the test and will not reply to client requests until it is "restarted". The server input script uses the CHANGE_STATE command to affect this as illustrated in the web server input script.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_web_server"></a>3.1.&nbsp;Web Server</h3></div></div></div><p>The <a name="_web_server"></a>Web Server is configured to be a simple stateless server that simply responds to various client "requests". An <a class="link" href="#_input_script" title="12.&nbsp;RAPR Input Script Format">input script</a> must be defined to tell the RAPR application emulating the web server to "listen" for TCP traffic as well as to set default application parameters.</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Example_Web_Server_Input_Script"></a>3.1.1.&nbsp;Example Web Server Input Script</h4></div></div></div><p>This simple input script directs the server to start listening for TCP traffic. All server behavior is response driven as defined in the logic table.</p><pre class="programlisting">
# Load the dictionary and logictable for the
# http application.  
LOAD_DICTIONARY dictionary-http.xml 
LOGICTABLE_FILE logictable-http.xml 


# Set unique hostId per rapr participant - this will default to the
# last octet of the node's ip address if not set
HOSTID 2

OVERWRITE_MGENLOG mgen-server-http.log
OVERWRITE_RAPRLOG rapr-server-http.log

# Listen for HTTP requests 
LISTEN TCP %HTTP_SERVER_PORT%

# Shutdown the server 120 seconds into the test
120.0 CHANGE_STATE %SERVER:STOPPED%

# Start the server back up a minute later, at 180 seconds into the test
180.0 CHANGE_STATE %SERVER:STARTED%

</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Example_Web_Server_Logictable"></a>3.1.2.&nbsp;Example Web Client Input Script</h4></div></div></div><p>This simple input script directs the client to start listening for TCP traffic. It initiates the emulated behavior via the PERIODIC behavior event. All server behavior is response driven as defined in the logic table.</p><pre class="programlisting"># Load the dictionary and logictable for the
# http application.  
LOAD_DICTIONARY dictionary-http.xml 
LOGICTABLE_FILE logictable-http.xml 


# Set unique hostId per rapr participant - this will default to the
# last octet of the node's ip address if not set
HOSTID 1


OVERWRITE_MGENLOG mgen-client-http.log
OVERWRITE_RAPRLOG rapr-client-http.log

# Listen for responses from the server
Listen TCP %HTTP_CLIENT_PORT%

# Send a request every 15 to 30 seconds 
DURATION 360 PERIODIC INTERVAL %SYSTEM:RANDOMI(15,30)% 
 DECLARATIVE SRC 5000 TCP DST %SERVER:IP%/%HTTP_SERVER_PORT% PERIODIC 
 [1 %SYSTEM:RANDOMI(76,2048)%] LOGICID 1 COUNT 1</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Example_Web_Server_Logictable"></a>3.1.3.&nbsp;Example Web Server Dictionary</h4></div></div></div><p>A common dictionary is used by both the http client and server.</p><pre class="programlisting">&lt;RaprDictionary&gt;
   &lt;namespace&gt;
   &lt;label&gt;DEFAULT&lt;/label&gt;
   &lt;item&gt;
       &lt;field&gt;HTTP_SERVER_PORT&lt;/field&gt;
       &lt;value&gt;8000&lt;/value&gt;
   &lt;/item&gt;
   &lt;item&gt;
       &lt;field&gt;HTTP_CLIENT_PORT&lt;/field&gt;
       &lt;value&gt;8001&lt;/value&gt;
   &lt;/item&gt;
   &lt;/namespace&gt;
   &lt;!-- Dictionary entries in the server name space should --&gt;
   &lt;!-- be referred to as %SERVER:&lt;FIELDNAME&gt;%, e.g.       --&gt;
   &lt;!-- %SERVER:IP%                                        --&gt;
   &lt;namespace&gt;
   &lt;label&gt;SERVER&lt;/label&gt;
       &lt;item&gt;
           &lt;field&gt;IP&lt;/field&gt;
           &lt;value&gt;10.0.0.2&lt;/value&gt;
       &lt;/item&gt;
       &lt;item&gt;
           &lt;field&gt;STARTED&lt;/field&gt;
           &lt;value&gt;0&lt;/value&gt;
       &lt;/item&gt;
       &lt;item&gt;
           &lt;field&gt;STOPPED&lt;/field&gt;
           &lt;value&gt;1&lt;/value&gt;
       &lt;/item&gt;
   &lt;/namespace&gt;
&lt;/RaprDictionary&gt;
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Example_Web_Server_Log_File"></a>3.1.4.&nbsp;Example Web Server Logic Table</h4></div></div></div><p>A common logic table is used by both the http client and server.</p><pre class="programlisting">
&lt;RaprLogicTable&gt;

  &lt;state&gt;
    &lt;!-- Default state, SERVER:STARTED --&gt;
    &lt;value&gt;0&lt;/value&gt;
    &lt;logicid&gt;
      &lt;!-- Logic id 1 initiates the interaction between the client
           and the server.  It is sent from the client to the server 
           and directs the server to send a single TCP packet
           or "web page" of random size with logic id 2 
           back to the client --&gt;
      &lt;id&gt;1&lt;/id&gt;
      &lt;entry&gt;DECLARATIVE TCP DST %PACKET:SRCIP%/%HTTP_CLIENT_PORT% PERIODIC 
             [1 %SYSTEM:RANDOMI(76,2048)%] COUNT 1 LOGICID 2&lt;/entry&gt;
    &lt;/logicid&gt;
    &lt;logicid&gt;
      &lt;!-- Logic id 2 is sent from the server to the client.
           It directs the client to send between 1 and 3
           TCP messages (or "requests for gif files") back to 
           the server.  These mesages(s) are associated with logic
           id 3. Note that the client has a 50% probability
           of making these requests. --&gt;
      &lt;id&gt;2&lt;/id&gt;
      &lt;percent&gt;0.5&lt;/percent&gt;
      &lt;entry&gt;DECLARATIVE TCP DST %PACKET:SRCIP%/%HTTP_SERVER_PORT% POISSON 
             [1 %SYSTEM:RANDOMI(76,2048)%] LOGICID 3 COUNT %SYSTEM:RANDOMI(1,3)%&lt;/entry&gt;
    &lt;/logicid&gt;
    &lt;logicid&gt;
      &lt;id&gt;3&lt;/id&gt;
      &lt;!-- Logic if 3 is sent from the client to the server.
           It directs the server to send a single TCP message (or "file")
           between 512 and 38192 bytes back to the client.  It is
           not associated with a logic id and "ends" the 
           interaction initiated by logic id 1. The server will
           respond between 1 and 3 times depending on how many 
           "http requests" (or packets associated with logic id 3
           it received from the client.--&gt;
      &lt;entry&gt;DECLARATIVE TCP DST %PACKET:SRCIP%/%HTTP_CLIENT_PORT% POISSON 
             [1 %SYSTEM:RANDOMI(512,38192)%] COUNT 1&lt;/entry&gt;
    &lt;/logicid&gt;
  &lt;/state&gt;

  &lt;state&gt;
      &lt;!-- The server script issues a CHANGE_STATE 
           command at 120 seconds into the test.  When
           the server is in this state (SERVER:STOPPED)
           it will not respond to any requests from the
           client. At 180 seconds into the test the
           server changes state back to SERVER:STARTED and the
           logic defind for SERVER:STARTED (state 0) 
           will be followed--&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;logicid&gt;
      &lt;!-- Server shut down - no response --&gt;      
         &lt;id&gt;0&lt;/id&gt;
         &lt;entry&gt;&lt;/entry&gt;
      &lt;/logicid&gt;
  &lt;/state&gt;
&lt;/RaprLogicTable&gt;

</pre><p></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Example_Web_Server_Log_File"></a>3.1.5.&nbsp;Plot of Web Server Application Behavior</h4></div></div></div><p>NRL's TRPR application can be used to create a gnuplot with the following command: (By default trpr will log send data only. Add the "send" and "recv" data options to log both SEND and RECV data.)</p><pre class="programlisting">
./trpr mgen input mgen-server-http.log auto X output mgen-server-http.plot Display the plot file via: gnuplot -persist mgen-server-http.plot </pre><p>Display the plot file via: </p><pre class="programlisting">gnuplot -persist mgen-server-http.plot </pre><p>This is plot of the application behavior:</p><p><img src="resources/mgen-server-http-plot.png"></p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e256"></a>3.2.&nbsp; Application Best Practices</h3></div></div></div><p>Application "best practices" are discussed below.  Some of these are illustrated in the sample applications in the rapr distribution.</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e261"></a>3.2.1.&nbsp;Set a HOSTID or INITIAL_SEED</h4></div></div></div><p>The initial seed used by all random behaviors in the system can be set via either the INTITIAL_SEED command or the HOSTID command.  The first of these commands encountered will be used to initialize the seed used by the random number generator.   If neither is set, the HOSTID will default to the last octet of the node's ip address and this value will be used as the initial seed.  Doing so is not recommended however, as this assignment will not occur until AFTER any other scripted behaviors are processed and seeding may not work properly. It should be set prior to any other commands.  Either as an event, e.g.:</p><pre class="programlisting">./rapr event "HOSTID 1" input &lt;inputScript&gt;</pre><p>or as the first entry in an input script</p><pre class="programlisting">HOSTID 1

....</pre><pre class="programlisting">INITIAL_SEED 10001

HOSTID 1</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e273"></a>3.2.2.&nbsp;Use a default input script.</h4></div></div></div><p>Use a default input script to defined rapr attributes common to all applications.</p><pre class="programlisting"># This input script sets the defaults for
# all rapr apps in the examples directory

# Log only error conditions
DEBUG 0

# Enable verbose logging
VERBOSE

# Enable transmission logging
TXLOG

# Flush the log immediately
FLUSH

# Load default dictionary
LOAD_DICTIONARY /home/rapr/rapr-scripts/rapr-default-dictionary.xml
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e280"></a>3.2.3.&nbsp;Use a default dictionary</h4></div></div></div><p>Use a default dictionary to define common dictionary translations.</p><pre class="programlisting">&lt;RaprDictionary&gt;
    &lt;namespace&gt; 
      &lt;label&gt;SystemDefaults&lt;/label&gt;
        &lt;!-- Application wide defaults --&gt;
      &lt;item&gt;
        &lt;field&gt;SCRIPT_PATH&lt;/field&gt;
        &lt;value&gt;/home/rapr/rapr-scripts&lt;/value&gt;
      &lt;/item&gt;
      &lt;item&gt;
        &lt;field&gt;HTTP_EXAMPLE_PATH&lt;/field&gt;
        &lt;value&gt;%SCRIPT_PATH%/simple-http-example&lt;/value&gt;
      &lt;/item&gt;
      &lt;item&gt;
        &lt;field&gt;HTTP_LOG_PATH&lt;/field&gt;
        &lt;value&gt;%HTTP_EXAMPLE_PATH%&lt;/value&gt;
      &lt;/item&gt;
    &lt;/namespace&gt;
&lt;/RaprDictionary&gt;</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e287"></a>3.2.4.&nbsp;Define a default directory structure</h4></div></div></div><p>As illustrated by the sample applications in the rapr source, the use of such conventions can simplify scripting.  By default, RAPR will look in the current directory for input files.  Given the default dictionary and input scripts discussed above, an application author need not redefine common defaults and directory paths in each script.  For example given an application input script "http-server.input" located in the "application" directory (in these examples /home/rapr/rapr-scripts/simple-http-example):</p><pre class="programlisting">
# Load the default rapr dictionary that defines
# paths and other system defaults.  If this script
# is not co-located with the rapr binary specify 
# a path
INPUT rapr-defaults.input

# Load the dictionary and logictable for the
# http application.  
LOAD_DICTIONARY %HTTP_EXAMPLE_PATH%/dictionary-http.xml 
LOGICTABLE_FILE %HTTP_EXAMPLE_PATH%/logictable-http.xml 

# Accept rapr commands over "rapr-server" pipe
RAPRPIPE rapr-server

# Uncomment the following lines to log mgen and/or rapr
# logging to an output file.  The OVERWRITE_&lt;type&gt;LOG command 
# will overwrite any existing log files. The &lt;type&gt;LOG command
# will append to any existing log file.

OVERWRITE_MGENLOG %HTTP_LOG_PATH%/mgen-server-http.log
OVERWRITE_RAPRLOG %HTTP_LOG_PATH%/rapr-server-http.log

.... &lt;rest of script&gt;


</pre><p>the "application" could be run as: </p><pre class="programlisting">cd /home/rapr/rapr-scripts

./rapr event "HOSTID &lt;n&gt;" input simple-http-example/http-server.input

</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e297"></a>3.2.5.&nbsp;Default port ranges</h4></div></div></div><p>Although not necessary, it is recommended to use port ranges 10,000 and above in the RAPR applications to deconflict with other services running on the system.  It is a also good idea to define a port range specific to an application.</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e302"></a>4.&nbsp;Host ID, Initial Seed, &amp; Repeatability</h2></div></div></div><p>RAPR uses a random number generator that can be seeded such that RAPR behavior and traffic patterns can be controlled and be repeatable across multiple scenario runs. Seeds are embedded within RAPR messages so that network initiated behavior is also repeatable. Likewise, the initial seed value can be changed so that multiple runs of the same scenario results in variable behavior and traffic patterns.</p><p>RAPR will use the <a class="link" href="#hostid">hostid</a> to seed the random number generator unless an <a class="link" href="#initial_seed">INITIAL_SEED</a> value is provided. If no <a class="link" href="#initial_seed">INITIAL_SEED</a> or <a class="link" href="#hostid">hostid</a> is specified, the default HostID (the last octet of the IP address) will be used as the initial seed value.</p><p>The INITIAL_SEED or the HOSTID should be sent to rapr via the event command before the input file is processed, or be included as the first line in the input script such that subsequent behaviors are seeded correctly.  Whichever command received first is used as the seed.  NOTE: if no initial_seed or hostid is set prior to input script processing no initial_seed is available for seeding entries in the script.</p><p>Note that <a class="link" href="#hostid">hostid</a> is also used by the RAPR application to identify it's own network traffic and as such must be unique within a set of interoperating rapr applications. Currently the maximum <a class="link" href="#">hostid</a> allowed is 255.</p><p><span class="emphasis"><em>Important: <a class="link" href="#initial_seed">INITIAL_SEED</a> and <a class="link" href="#hostid">hostid</a> must be specified as the first entries in an input script as subsequent commands may require that random number draws be made. <a class="link" href="#">INITIAL_SEED</a> should always be specified first (if set), followed by <a class="link" href="#hostid">hostid</a> (if set).</em></span></p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e346"></a>5.&nbsp;Unique Behavior Identifier (UBI)</h2></div></div></div><p>Each behavior event created by RAPR is associated with a Unique Behavior Identifier (UBI) that serves to uniquely identify behavior "events" in the system. Behavior events manage and control message transmission and reception and other "system behaviors" (e.g. load a dictionary file, join/leave a multicast group).</p><p>It is also embedded in the payload of messages sent by interrogative events and is used by a RAPR instance to identify its own message traffic or responses to its own solicitations.</p><p>For example, RAPR will embed a UBI in messages to which it expects a response. Interrogative objects that are soliciting a reply will do this for example. In the following log file message, the UBI is the first field in the RAPR data. (0104-01000073 is the hex equivalent of a ubi "1929379841").</p><pre class="programlisting">11:45:40.277483 app&gt;RAPR type&gt;Interrogative action&gt;start ubi&gt;1929379841 \
eventSource&gt;script_event cnt&gt;0 mgenCmd&gt;"ON 1 UDP SRC 6000 DST \
192.168.1.103/5000 PERIODIC [1 1024 ] DATA [<span class="bold"><strong>010401000073</strong></span>020403000000\
0304CBE4A304]"</pre><p>When the target RAPR responds to this message, it will embed the (now) "foreign ubi" in the payload of its responses.</p><pre class="programlisting">15:45:40.284519 RECV proto&gt;UDP flow&gt;1 seq&gt;1 src&gt;192.168.1.103/33923 \
dst&gt;192.168.1.102/6000 sent&gt;15:45:40.282034 size&gt;1024 gps&gt;INVALID,\
999.000000,999.000000,-999 data&gt;12:0304B0F0810204<span class="bold"><strong>0401000073</strong></span></pre><p> The RAPR receiving this response packet then looks for the interrogative object associated with this "foreign ubi" that is waiting for a reply. If it finds one, the "transaction" is considered successful and no further messages are sent.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e368"></a>6.&nbsp;Script synchronization.</h2></div></div></div><p>To assist in starting application or "scenario" scripts across a network, RAPR provides a START command that designates an absolute start time. This &lt;hour:min:sec&gt; field corresponds to the relative script time of 0.0 seconds. All transmission and reception events will be scheduled relative to this absolute start time. The optional GMT suffix (no white space after the time) indicates that the clock time given is Greenwich Mean Time (GMT) rather than the operating systems local time zone. If no START command is given, RAPR schedules transmission and reception events relative to program startup. For example:</p><pre class="programlisting">#Start RAPR exactly at 1:30PM local time
START 13:30:00

#Start RAPR at 30 seconds past 8:30 
START 8:30:30GMT</pre><p>When specifying an absolute start time, it is important that the system clocks of network nodes be synchronized via a time protocol such as NTP or GPS.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e377"></a>7.&nbsp;RAPR System Defaults</h2></div></div></div><p>The RAPR application provides certain application wide default values. In addition, a "default" dictionary is provided in the RAPR distribution that can be used to override these application wide default values. If no default dictionary is loaded into a running RAPR application via a "LOAD_DICTIONARY" command RAPR will default to using the values as specified in the table below. The "dictionary Field" columns lists the dictionary field names that must be used in the DEFAULT system name space. The "system value" lists the internal application wide default that can be overridden in the default dictionary.</p><p>The default dictionary is included in the RAPR distribution in the unix directory. It is called "raprDictionary.xml".</p><div class="table"><a name="d0e385"></a><p class="title"><b>Table&nbsp;1.&nbsp;Default Dictionary</b></p><div class="table-contents"><table summary="Default Dictionary" border="1"><colgroup><col width="33%"><col width="33%"><col width="34%"></colgroup><thead><tr><th align="center">Dictionary Field</th><th align="center">System Value</th><th align="center">Comments</th></tr></thead><tbody><tr><td>RETRYINTERVAL</td><td>10</td><td>The default retry interval used by an interrogative object if no RETRYINTERVAL attribute is specified.</td></tr><tr><td>NUMRETRIES</td><td>3</td><td>The default number of retries used by an interrogative object if no NUMRETRIES attribute is specified.</td></tr><tr><td>PATTERN</td><td>PERIODIC [1 1024]</td><td>The default mgen flow pattern that is used for all behavior events when no PATTERN is specified.</td></tr><tr><td>STREAMDURATION</td><td>.99</td><td>The default stream duration that is used by the interrogative object for each message query or as the default duration for declarative objects. See the object definitions for more details on how this interval is used/calculated.</td></tr><tr><td>PROTOCOL</td><td>UDP*</td><td>The default protocol to be used by all behavior events. Note that this default can <span class="emphasis"><em>only</em></span> be set in the default dictionary. No internal default PROTOCOL is set system wide. If no entry is set specified in the default dictionary, the PROTOCOL <span class="emphasis"><em>must</em></span> be set on the command line for each behavior event.</td></tr></tbody></table></div></div><p><br class="table-break"></p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_RAPR_Usage:"></a>8.&nbsp;RAPR Usage</h2></div></div></div><p>The RAPR version 1.x program must currently be launched from a command-line. To launch RAPR, use the following command-line syntax:</p><pre class="programlisting">
RAPR [input &lt;scriptFile&gt;]
     [overwrite_raprlog &lt;logFile&gt;] 
     [raprlog &lt;logFile&gt;]
     [overwrite_mgenlog &lt;logFile&gt;]
     [mgenlog &lt;logFile&gt;]
     [binary]
     [event "&lt;RAPR event&gt;"]
     [instance &lt;name&gt;]
     [offset &lt;offsetTime&gt;]
     [start &lt;startTime&gt;]
     [verbose]
     [enable_load_emulator]
     [initial_seed &lt;initial_seed&gt;]
     [hostid &lt;hostid&gt;]
     [txlog]
     [nolog]
     [flush]
     [interface &lt;interfaceName&gt;]
     [ttl &lt;timeToLive&gt;]
     [tos &lt;typeOfService&gt;]
     [label &lt;value&gt;]
     [txbuffer &lt;txSocketBufferSize&gt;]
     [rxbuffer &lt;rxSocketBufferSize&gt;]
     [txcheck]
     [rxcheck]
     [check]
     [stop]
     [debug &lt;debugLevel&gt;]
</pre><p>Most of these command-line options can also be included in the RAPR input script.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Command-line_Options"></a>8.1.&nbsp;Command-line Options</h3></div></div></div><p>Some of these command-line options can also be included in RAPR script files as "<a class="link" href="#_GLOBAL" title="14.2.&nbsp;Global Commands">global</a>" commands or defaults. Note the command-line (or commands sent via RAPR's remote control interface) will always override settings from script files.</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td><a class="link" href="#_INPUT" title="14.2.11.&nbsp;INPUT">input</a> &lt;scriptFile&gt;</td><td>Causes RAPR, to parse the given &lt;scriptFile&gt; at startup and schedule any transmission or reception events given in the script.</td></tr><tr><td><a class="link" href="#_OVERWRITE_RAPRLOG" title="14.2.12.&nbsp;OVERWRITE_RAPRLOG">overwrite_raprlog</a> &lt;logFile&gt;</td><td>Causes RAPR to output RAPR behavior event and application information to the indicated &lt;logFile&gt;. By default, RAPR will log to stdout. With the overwrite_raprlog command, an existing &lt;logFile&gt; of the same name will be overwritten. Use the raprlog command to append to an existing log file. Some application errors are only logged to stdout.</td></tr><tr><td><a class="link" href="#_RAPRLOG" title="14.2.14.&nbsp;RAPRLOG">raprlog</a> &lt;raprlog&gt;</td><td>This is the same as the overwrite_raprlog command except that if &lt;logFile&gt; already exists, it will be appended instead of replaced.</td></tr><tr><td><a class="link" href="#_OVERWRITE_MGENLOG" title="14.2.13.&nbsp;OVERWRITE_MGENLOG">overwrite_mgenlog</a> &lt;logFile&gt;</td><td>Causes RAPR to output mgen traffic information to the indicated &lt;logFile&gt;. By default, RAPR will log to stdout. With the overwrite_mgenlog command, an existing &lt;logFile&gt; of the same name will be overwritten. Use the mgenlog command to append to an existing log file.</td></tr><tr><td><a class="link" href="#">mgenlog</a> &lt;mgenlog&gt;</td><td>This is the same as the overwrite_mgenlog command except that if &lt;logFile&gt; already exists, it will be appended instead of replaced.</td></tr><tr><td><a class="link" href="#_Binary" title="17.&nbsp;Binary Log File Format">binary</a></td><td>Causes RAPR to save mgen output logging information in a smaller-sized binary file format. This option should come before the mgenlog or overwrite_mgenlog or log commands.</td></tr><tr><td>event "&lt;RAPR event&gt;"</td><td>The event command allows the user to enter the equivalent of RAPR script lines into RAPR via the command-line. Multiple event commands can be used to pass the equivalent of a multi-line script to RAPR. Note that RAPR script events generally contain spaces and thus must be encapsulated in quotes on the command line. Note that the &lt;eventTime&gt; may be omitted and the action indicated by the event will be taken by RAPR immediately.</td></tr><tr><td><a class="link" href="#_RAPR_run-time_interface" title="9.&nbsp;Run-Time Interface">instance</a> &lt;instanceName&gt;</td><td>If a pre-existing RAPR application instance is _not_ already running, this command registers the running RAPR program as an instance identified by the &lt;instanceName&gt;. On UNIX, this corresponds to a Unix-domain datagram socket named "/tmp/&lt;instanceName&gt;" being opened and monitored for RAPR commands These interprocess channels allow for run-time control of RAPR processes. If an application instance as identified by the &lt;instanceName&gt; parameter is already running, any subsequent command-line options are transmitted to the remote instance already running, and the new RAPR instance will then exit.This allows run-time control of possibly multiple background RAPR instances from the "shell" or via scripting. The event command may be used to dispatch RAPR script events to RAPR instances at run-time.</td></tr><tr><td><a class="link" href="#_OFFSET" title="14.2.4.&nbsp;OFFSET">offset</a> &lt;sec&gt;</td><td>Causes RAPR to skip &lt;sec&gt; seconds of relative time into the execution of the script file used. Note that if an absolute start time is given using the start command, the offset into the script will correspond to that absolute time. The default offset for RAPR is 0.0 seconds.</td></tr><tr><td><a class="link" href="#_START" title="14.2.3.&nbsp;START">start</a> &lt;hr:min:sec&gt;[GMT]</td><td>Causes RAPR to delay processing events in script file relative to the indicated absolute time. The optional "GMT" keyword indicates the time is Greenwich Mean Time instead of the default local time. This command establishes an absolute time for the relative script time of 0.0 seconds.</td></tr><tr><td>verbose</td><td>This causes raprlog output to be more verbose.</td></tr><tr><td>enable_load_emulator</td><td>This enables application load emulation functionality in the RAPR application. This feature is not fully implemented.</td></tr><tr><td><a class="link" href="#hostid">hostid</a></td><td>This command specifies the HOSTID to be used by RAPR. Although available as a command-line option, it is not recommended to be used this way as it will be overwritten by any subsequent HOSTID definitions in the input script if specified. HOSTID is embedded in unique behavior identifiers (see <a class="link" href="#_ubi_state" title="10.7.&nbsp;UBI State in the Behavior Table">CHANGE_UBI_STATE</a> for more information on UBI) that are used by the RAPR application to identify it's own network traffic and as such must be unique within a set of interoperating RAPR applications. If no HOSTID command is specified, the application will use the DEFAULT hostId as indicated by the node's local ip address. For example, given an ip address of 192.168.1.103, "103" will be used as the hostid if not overridden by the HOSTID command.</td></tr><tr><td>initial_seed</td><td>This command specifies the default initial seed used by RAPR. If not specified, the DEFAULT host id as indicated by the node's local ip address will be used as the initial_seed value.</td></tr><tr><td>txlog</td><td>This enables transmission logging. This results in transmitted network events being added to the log file every time a packet is sent by RAPR (MGEN).</td></tr><tr><td>nolog</td><td>This disables mgen logging completely.</td></tr><tr><td>flush</td><td>This causes the output log file to be flushed with each line written. This is useful for real-time monitoring of RAPR logging</td></tr><tr><td><a class="link" href="#_INTERFACE" title="14.2.10.&nbsp;INTERFACE">interface</a> &lt;interfaceName&gt;</td><td>Causes RAPR to set the default network interface for IP multicast and/or root node flow transmission to &lt;interfaceName&gt;. &lt;interfaceName&gt; will override any default interface specified within an RAPR script file. &lt;interfaceName&gt; is a "per socket" attribute, and in its absence, RAPR will behave according to the operating system's default behavior.</td></tr><tr><td><a class="link" href="#_TTL" title="14.2.7.&nbsp;TTL">ttl</a> &lt;timeToLive&gt;</td><td>Causes RAPR to set the hop count for IP multicast traffic generated by RAPR. &lt;timeToLive&gt; will override any default ttl indicated within an RAPR script file. &lt;timeToLive&gt; is a "per socket" attribute. If no ttl option is used, RAPR will behave according to the operating system's default behavior.</td></tr><tr><td><a class="link" href="#_TOS" title="14.2.5.&nbsp;TOS">tos</a> &lt;typeOfService&gt;</td><td>Causes RAPR to set the IPv4 type-of-service field (within the packet header) to &lt;typeOfService&gt;. &lt;typeOfService&gt; will override any default tos indicated within an RAPR script file. As with ttl and interface, tos is a "per socket" attribute. If no tos option is used, RAPR will behave according to the operating system's default behavior.</td></tr><tr><td><a class="link" href="#_LABEL" title="14.2.6.&nbsp;LABEL">label</a> &lt;value&gt;</td><td>Causes RAPR to set &lt;value&gt; as the default flow label for IPv6 flows. The &lt;value&gt; corresponds to the 28-bit IPv6 flow label field and may be specified in decimal or hex.</td></tr><tr><td><a class="link" href="#_TXBUFFER" title="13.5.8.&nbsp;Socket Transmit Buffer Size (TXBUFFER)">txbuffer</a> &lt;bufferSize&gt;</td><td>Causes RAPR to set the socket transmit buffer size to a value &Ograve;at least&Oacute; as large as &lt;bufferSize&gt;. If &lt;bufferSize&gt; is larger that the maximum allowed by the system, &lt;bufferSize&gt; will be set to the system maximum.</td></tr><tr><td><a class="link" href="#">rxbuffer</a> &lt;bufferSize&gt;</td><td>Causes RAPR to set the socket receive buffer size to a value &Ograve;at least&Oacute; as large as &lt;bufferSize&gt;. If &lt;bufferSize&gt; is larger that the maximum allowed by the system, &lt;bufferSize&gt; will be set to the system maximum.</td></tr><tr><td>txcheck</td><td>Causes RAPR to include an optional 32-bit cyclic redundancy checksum (CRC) at the end of its messages. The CHECKSUM flag is set to indicate the presence of the checksum content.</td></tr><tr><td>rxcheck</td><td>Forces RAPR receivers to validate the checksum portion (last 4 bytes) of RAPR messages whether or not the CHECKSUM flag is set in the RAPR flags message field. Use this option when it is _known_ that the RAPR sender is supplying checksums to cover the case when the flags field itself is possibly corrupted.</td></tr><tr><td>check</td><td>Sets RAPR behavior as if both the txcheck _and_ rxcheck commands were applied. This is the recommended option when RAPR checksum operation is desired so that both senders and receivers are providing and validating checksums, respectively.</td></tr><tr><td>stop</td><td>This command causes RAPR to exit. This is useful for run-time control of RAPR instances.</td></tr></tbody></table></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e628"></a>8.2.&nbsp;Upper and Lower case support</h3></div></div></div><p>All RAPR commands and behavior events can be scripted in both lower case and upper case, e.g. both the following formats are acceptable:</p><pre class="programlisting">DECLARATIVE UDP SRC 5000 DST 192.168.1.100/6000
declarative udp src 5000 dst 192.168.1.100/6000</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e635"></a>8.3.&nbsp;Shorthand</h3></div></div></div><p>Shorthand notation is available for certain attributes, e.g.</p><pre class="programlisting">DECLAR DST 192.168.1.100/5000 
INTERR DST 192.168.1.100/5000</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Example_Usage"></a>8.4.&nbsp;Example Usage</h3></div></div></div><p>To run RAPR with script file "script.mgn" and log to stdout (by default):</p><pre class="programlisting">RAPR input script.mgn</pre><p>The "event" command can be used to invoke RAPR commands with the command-line syntax:</p><pre class="programlisting">RAPR event "listen udp 5000,5004-5006" mgenlog log.mgn</pre><p>The "event" command allows for use of RAPR without script files for "quick and dirty" runs. RAPR is capable of being dynamically scripted during run time with "event" commands passed to RAPR via inter-process communication (see RAPR Run-Time Remote Control.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_RAPR_run-time_interface"></a>9.&nbsp;Run-Time Interface</h2></div></div></div><p>To use the RAPR "remote control interface":</p><p>Start one (or more) instance(s) of RAPR to control, either by the command line: RAPR instance RAPR1 or by the <a class="link" href="#_raprpipe" title="14.1.9.&nbsp;RAPRPIPE">RAPRPIPE</a> command in a RAPR input script.</p><p>Subsequent invocations of RAPR with the same instance name will pass provided commands to the first instance and then exit: (Note that the quotes around the event definition are required.)</p><pre class="programlisting">
RAPR instance RAPR1 event "0.0 DECLARATIVE UDP DST 127.0.0.1/5000 PERIODIC [1 1024]"</pre><p>The second instance (Step #2) will exit after it has passed its commands to the first running instance as identified by the &lt;instanceName&gt;. Note this can allow run-time control of multiple RAPR instances by user(s), shell scripts, or other processes. A programmer comfortable with use of Unix-domain sockets or using the NRL Protolib "ProtoPipe" C++ class can also write software for run-time control of RAPR processes.</p><p>Specifying a 0.0 start time for the events will cause the behavior event to start immediately, e.g. as soon as the event is parsed. Otherwise the event will be scheduled relative to the running rapr's offset time.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_behavior_table"></a>10.&nbsp;Behavior Event Table</h2></div></div></div><p>The Behavior Event Table, sometimes referred to as "a logic table " is used to define a node's response to a logic id. The behavior associated with a logic id in the behavior event table is the same as that that can be defined in an <a class="link" href="#_input_script" title="12.&nbsp;RAPR Input Script Format">input script</a> or over the <a class="link" href="#_RAPR_run-time_interface" title="9.&nbsp;Run-Time Interface">run-time interface</a>, e.g. <a class="link" href="#">behavior events</a>,<a class="link" href="#">reception events</a>, and <a class="link" href="#_Rapr_Events" title="14.&nbsp;Rapr Events and Global Commands">rapr events</a>. The logic id may come from the following <a name="_triggering_event"></a>triggering events:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"> a payload logic id of an incoming network packet </li><li class="listitem"> a <a class="link" href="#">LOGICID</a> RAPR event command </li><li class="listitem"> from a SUCCESS, TIMEOUT, or FAILURE logic ID associated with a local <a class="link" href="#">behavior event</a> . </li></ul></div><p>The behavior event table is created when a behavior event XML file is parsed. The format of this XML file is (briefly):</p><pre class="programlisting">
&lt;RaprLogicTable&gt;
   &lt;<a class="link" href="#_state" title="10.1.&nbsp;<state&gt;">state</a>&gt;
      &lt;value&gt;STATE&lt;/value&gt;
   &lt;<a class="link" href="#_logicid" title="10.2.&nbsp;<logicid&gt;">logicid</a>&gt;
      &lt;id&gt;ID&lt;/id&gt;
          &lt;<a class="link" href="#_percent" title="10.3.&nbsp;<percent&gt;">percent</a>&gt;PERCENT&lt;/percent&gt;
           &lt;<a class="link" href="#_entry" title="10.4.&nbsp;<entry&gt;">entry</a>&gt;ENTRY&lt;/entry&gt;
           &lt;<a class="link" href="#_entry" title="10.4.&nbsp;<entry&gt;">entry</a>&gt;ENTRY&lt;/entry&gt;
   &lt;/state&gt;
&lt;/RaprLogicTable&gt;
</pre><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_state"></a>10.1.&nbsp;&lt;state&gt;</h3></div></div></div><p>The &lt;state&gt; XML tag forms a block around logic id's that can be used when the RAPR application is in that system <a class="link" href="#_state" title="10.1.&nbsp;<state&gt;">state</a>. Multiple state blocks can be defined in the same file.</p><p>State value has the format &lt;globalState,ubiState&gt;. See <a class="link" href="#_ubi_state" title="10.7.&nbsp;UBI State in the Behavior Table">ubi state</a> for more information on the use of the optional ubi state attribute. &lt;globalState&gt; has the format &lt;x.y.z&gt; where x,y, and z are integers. If no &lt;state&gt; tag is defined, only the default state &lt;0&gt; will exist. System state is changed by the <a class="link" href="#_CHANGE_STATE" title="14.1.5.&nbsp;CHANGE_STATE">CHANGE_STATE</a> rapr event command.</p><p>For legibility, the <a class="link" href="#_dictionary" title="11.&nbsp;Dictionary">dictionary's</a> function can be used to translate the state value from a more readable english format to its integer counterpart. (E.g. global state might be defined as &lt;SHUTTING_DOWN&gt; in the behavior table rather than n.n.n).</p><pre class="programlisting">
&lt;RaprLogicTable&gt;
   &lt;state&gt;
      &lt;value&gt;%SHUTTING_DOWN%&lt;/value&gt;
         &lt;logicid&gt;
            &lt;id&gt;2&lt;/id&gt;
                &lt;entry&gt;CHANGE_STATE %STOPPED%&lt;/entry&gt;
         &lt;/logicid&gt;
   &lt;/state&gt;
   &lt;state&gt;
      &lt;value&gt;2.2.0&lt;/value&gt;
         &lt;logicid&gt;
            &lt;id&gt;2&lt;/id&gt;
                &lt;entry&gt;CHANGE_STATE %STARTED%&lt;/entry&gt;
         &lt;/logicid&gt;
   &lt;/state&gt;
&lt;/RaprLogicTable&gt;
</pre><p>See additional notes on <a class="link" href="#_ubi_state" title="10.7.&nbsp;UBI State in the Behavior Table">UBI state</a> below.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_logicid"></a>10.2.&nbsp;&lt;logicid&gt;</h3></div></div></div><p>The &lt;logicid&gt; tag forms a block around the &lt;behavior(s)&gt; to be performed when the specified ID is recieved when the system is in the state corresponding to the surrounding &lt;state&gt; block. The ID is the integer id value assigned to the logicid tag and is a required field.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_percent"></a>10.3.&nbsp;&lt;percent&gt;</h3></div></div></div><p>PERCENT is an optional field that defines the probability of triggering the event. The percentage is a float between 0 and 1. If the value is not defined, a 1 is assigned as the default, (always do the behavior). The <a class="link" href="#">seed</a> of the triggering event is used to calculate the probability of response.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_entry"></a>10.4.&nbsp;&lt;entry&gt;</h3></div></div></div><p>ENTRY is the tag that identifies the behavior to invoke in response to the logic ID. Multiple entries can be specified for a given logic id. A minimum of one entry is required, there is no maximum limit. The format of the specified behavior events is the same as that defined for the <a class="link" href="#_input_script" title="12.&nbsp;RAPR Input Script Format">input script</a> or over the <a class="link" href="#_RAPR_run-time_interface" title="9.&nbsp;Run-Time Interface">run-time interface</a>, e.g. <a class="link" href="#">behavior events</a>,<a class="link" href="#">reception events</a>, and <a class="link" href="#_Rapr_Events" title="14.&nbsp;Rapr Events and Global Commands">RAPR events</a>.</p><p><span class="bold"><strong>Important:</strong></span> Specifying a 0.0 start time for the events will cause the behavior event to start immediately, e.g. as soon as the event is parsed. Otherwise the event will be scheduled relative to the current offset time.</p><p>For example, if the test offset time is 10 seconds, a behavior event specified in the table to start at time 5.0 would start in 5 seconds, at test time 15.0. Any event in which NO start time is specified would be scheduled to start at test time 10.0 seconds. Note that his may result in additional behaviors being scheduled prior to the given event. It is particularly important to fully specify a 0.0 start time when doing state changes in order to control the ordering in which multiple events are enqueued.</p><pre class="programlisting">
&lt;RaprLogicTable&gt;
   &lt;state&gt;
      &lt;value&gt;0.0.0&lt;/value&gt;
         &lt;logicid&gt;
            &lt;id&gt;1&lt;/id&gt;
               &lt;entry&gt;STOP 5.0 DECLARATIVE UDP SRC 5001 
                          DST 192.168.1.102/5000 
                          PERIODIC [1 2048] LOGICID 9&lt;/entry&gt;
               &lt;/logicid&gt;
      &lt;logicid&gt;
         &lt;id&gt;5&lt;/id&gt;
            &lt;percent&gt;0.8&lt;/percent&gt;
               &lt;entry&gt;DECLARATIVE UDP SRC 6001 DST %PACKET:SRCIP%/5001 
                          LOGICID 11 SEED %PACKET:SEED%&lt;/entry&gt;
      &lt;/logicid&gt;
      &lt;logicid&gt;
         &lt;id&gt;8&lt;/id&gt;
            &lt;entry&gt;DECLARATIVE UDP SRC 5001 DST 192.168.1.102/5000&lt;/entry&gt; 
            &lt;entry&gt;DURATION 10.0 INTERROGATIVE RETRYINTERVAL 1.0 
                       NUMRETRIES 5 UDP SRC 5001 DST 192.168.1.100/5000 
                       PERIODIC [1 2048] FAILURE 4&lt;/entry&gt;
      &lt;/logicid&gt;
   &lt;/state&gt;
&lt;RaprLogicTable&gt;
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_word_replacement"></a>10.5.&nbsp;Word Replacement in the Behavior Table</h3></div></div></div><p>Word replacement is supported in the behavior table xml file so that scripting of the logic table is more legible and more easily standardized across multiple machines using a common <a class="link" href="#_dictionary" title="11.&nbsp;Dictionary">dictionary</a>. For example, given a <a class="link" href="#_dictionary" title="11.&nbsp;Dictionary">dictionary</a> translation defined as:</p><pre class="programlisting">
   &lt;item&gt;
     &lt;field&gt;TN-61&lt;/field&gt;
     &lt;value&gt;192.168.2.61&lt;/value&gt;
   &lt;/item&gt;
</pre><p>The behavior table &lt;entry&gt; of:</p><pre class="programlisting">
&lt;entry&gt;DECLARATIVE UDP SRC 6001 DST %TN-61%/5001 LOGICID 11
</pre><p>Would be translated to:</p><pre class="programlisting">
DECLARATIVE UDP SRC 6001 DST 192.168.2.61/5001 PERIODIC [1 1024] LOGICID 11
</pre><p>as the logic table is interpreted.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_namespace"></a>10.6.&nbsp;Name Spaces in the Behavior Table</h3></div></div></div><p>The <a class="link" href="#_dictionary-namespace" title="11.1.&nbsp;Namespace in the Dictionary">dictionary's namespace</a> feature can also be used to differentiate common dictionary names. For example, the IP address of the incoming packet and the IP address of the machine might both be referred to as &lt;SRCIP&gt;. The PACKET namespace (that is reserved for information stored in the incoming packet) could be used to refer to the IP address of the incoming packet. For example:</p><pre class="programlisting">
DECLARATIVE UDP SRC 6001 DST %PACKET:SRCIP%/5001 PERIODIC [1 2048] LOGICID 11
</pre><p>See <a class="link" href="#_dictionary" title="11.&nbsp;Dictionary">dictionary</a> for more information</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_ubi_state"></a>10.7.&nbsp;UBI State in the Behavior Table</h3></div></div></div><p>UBI is an unique behavior identifier associated with each behavior triggered by the script or logic table. The idea behind UBI State is to be able to handle multiple packet requests and retries (from an <a class="link" href="#_interrogative" title="13.2.&nbsp;Interrogative Event">INTERROGATIVE</a> event that did not successfully receive a response packet for example).</p><p>An example might best illustrate an application of this functionality: Node A requests a response from Node B. Node B is configured to respond to the request with an "acknowledgement" (or single declarative response) and after a random interval, to send a "file" (a multi-packet declarative response) back to the Node A. When Node B receives the triggering request, it should respond with the acknowledgement and schedule the transmission of the file after the random interval.</p><p>Without using UBI state change functionality, if Node A did not not receive the initial acknowledgement, and retransmitted a second request for the information, Node B would respond with a second acknowledgement and schedule the transmission of a second file after a random interval.</p><p>UBI State change can be used to direct Node B to "remember" that is has already successfully received the initial response. When Node B receives the first response, it can change the state associated with the initial message, so that any subsequent responses only generate "acknowledgements" of the request, not additional file responses (if that is the desired behavior).</p><p>Every action received will start at UBI State 0. A change in the UBI state of each action can be accomplished by a "<a class="link" href="#_change_ubi_state" title="14.1.6.&nbsp;CHANGE_UBI_STATE">CHANGE_UBI_STATE</a> %packet:ubi% x" command where x is the new UBI State. This command is only available in the Logic Table as it only pertains to incoming data packet. The idea is to be able to determine whether a request from an interrogative event has already been acted upon or is it the first time encountering the packet.</p><pre class="programlisting">
&lt;RaprLogicTable&gt;
   &lt;state&gt;
       &lt;value&gt;STATE,UBI_STATE&lt;/value&gt;
       &lt;logicid&gt;
	          ...
       &lt;logicid&gt;
   &lt;/state&gt;
&lt;/RaprLogicTable&gt;
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The ~first~ packet received associated with an interrogative object's ubi will trigger the interrogative object to "succeed" and any logic id associated with this ~first~ packet will be processed.</p><p>Likewise, any logic id's associated with any subsequent packets will be processed, which may be sent by different data streams - e.g. two declaratives responding to the initial interrogative query that are associated with payload logic id's.</p><p>Note that if the user is relying on any ubi state changes to effect behavior - he must take care that he provisions for both logic id's in both table states and consider the order in which they may arrive, and the state of the table in which they arrive. E.g. if one logic id causes a ubi state change - all subsequent logic id's received that are associated with that ubi will be looked up in the ubi state table.</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_dictionary"></a>11.&nbsp;Dictionary</h2></div></div></div><p>The Dictionary can be used to translate name-value pairs used in the event definitions in the <a class="link" href="#_input_script" title="12.&nbsp;RAPR Input Script Format">input script</a> and <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a>. The dictionary is created when the dictionary XML file is parsed. The format of this XML file is (briefly):</p><pre class="programlisting">
&lt;RaprDictionary&gt;
   &lt;<a class="link" href="#_dictionary-namespace" title="11.1.&nbsp;Namespace in the Dictionary">namespace</a>&gt;
      &lt;label&gt;NAMESPACENAME&lt;/label&gt;
   &lt;item&gt;
       &lt;<a class="link" href="#_field" title="11.2.&nbsp;Field">field</a>&gt;FIELDNAME&lt;/field&gt;
        &lt;<a class="link" href="#_value" title="11.3.&nbsp;Value">value</a>&gt;VALUE1&lt;/value&gt;
        &lt;<a class="link" href="#_value" title="11.3.&nbsp;Value">value</a>&gt;VALUE2&lt;/value&gt;
   &lt;/item&gt;
   &lt;/namespace&gt;
&lt;/RaprDictionary&gt;

</pre><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_dictionary-namespace"></a>11.1.&nbsp;Namespace in the Dictionary</h3></div></div></div><p>The NAMESPACE tag is used to differentiate common dictionary names that can be referenced by the format %NAMESPACE-LABEL:VALUE-NAME%. In the event that %VALUE-NAME is not specified in the given namespace, the replacement will be the first match of the field name over all the namespaces. (See <a class="link" href="#_reserved_namespaces" title="11.6.&nbsp;Reserved Namespaces">reserved namespaces</a> for more namespace options.) For example, given a namespace definition of:</p><pre class="programlisting">
&lt;namespace&gt;
   &lt;label&gt;HOST&lt;/label&gt;
       &lt;item&gt;
           &lt;field&gt;SRCIP&lt;/field&gt;
           &lt;value&gt;192.168.1.2&lt;/value&gt;
        &lt;/item&gt;
&lt;/namespace&gt;
</pre><p>%HOST:SRCIP% will be translated to the value "192.168.1.2"</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_field"></a>11.2.&nbsp;Field</h3></div></div></div><p>FIELDNAME is the name of the word to be replaced without the % surrounding the word. %DESTINATION% in the following example would be translated to "192.168.2.102". This is a required field.</p><pre class="programlisting">
&lt;namespace&gt;
   &lt;label&gt;DEFAULT&lt;/label&gt;
   &lt;item&gt;
      &lt;field&gt;DESTINATION&lt;/field&gt;
      &lt;value&gt;192.168.2.102&lt;/value&gt;
   &lt;/item&gt;
&lt;/namespace&gt;
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_value"></a>11.3.&nbsp;Value</h3></div></div></div><p>The VALUE entry should contain the values used to replace the field. Multiple values can be assigned to the same field. Each will be used to create an independent statement. Null is a valid entry for the value. One or more values are required. Given the example:</p><pre class="programlisting">
&lt;namespace&gt;
   &lt;label&gt;DEFAULT&lt;/label&gt;
   &lt;item&gt;
      &lt;field&gt;LOCALHOST&lt;/field&gt;
      &lt;value&gt;127.0.0.1&lt;/value&gt;
   &lt;/item&gt;
   &lt;item&gt;
      &lt;field&gt;DESTINATION&lt;/field&gt;
      &lt;value&gt;192.168.2.102&lt;/value&gt;
      &lt;value&gt;192.168.2.103&lt;/value&gt;
   &lt;/item&gt;
&lt;/namespace&gt;
</pre><p>and given an event definition of:</p><pre class="programlisting">
DECLARATIVE UDP SRC 5000 DST %DESTINATION%/5001
</pre><p>TWO events would be created as there are TWO values associated with the %DESTINATION% field name. There is no dependence or interaction between the two statements, both are treated as if they were separately declared to begin with.</p><pre class="programlisting">
DECLARATIVE UDP SRC 5000 DST 192.168.2.102/5001 PERIODIC [1 1024]
DECLARATIVE UDP SRC 5000 DST 192.168.2.103/5001 PERIODIC [1 1024]
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_hostid"></a>11.4.&nbsp;HOSTID Keyword</h3></div></div></div><p>The HOSTID keyword will be translated to the HOSTID assigned in the input script. (Note that the HOSTID will be automatically added to the dictionary, and any existing HOSTID value will be replaced). The functionality facilitates having common script/logictable syntax across multiple nodes where appropriate. Dictionary lookups my then be made as follows:</p><p>Given HOSTID=63, a dictionary translation of the string:</p><pre class="programlisting">
%%HOSTID%FIELD%
</pre><p>Would lookup 63FIELD in the dictionary:</p><pre class="programlisting">
&lt;name&gt;63FIELD&lt;/name&gt;
&lt;value&gt;FIELD_VALUE&lt;/name&gt;
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Nested_dictionary_translations"></a>11.5.&nbsp;Nested dictionary translations</h3></div></div></div><p>Nested dictionary translations within a field name are supported. The value of the nested field will be associated with the non-nested field name to lookup the final value(s). Given dictionary entries of:</p><pre class="programlisting">
&lt;name&gt;NESTED_FIELD&lt;/name&gt;
&lt;value&gt;VALUE_OF_NESTED_FIELD&lt;/value&gt;
&lt;name&gt;VALUE_OF_NESTED_FIELD-NON_NESTED_FIELD&lt;/name&gt;
&lt;value&gt;FINAL_VALUE
</pre><p>The script/logictable entry of:</p><pre class="programlisting">
%%NESTED_FIELD%-NON_NESTED_FIELD%
</pre><p>would be translated as:</p><pre class="programlisting">

FINAL_VALUE
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_reserved_namespaces"></a>11.6.&nbsp;Reserved Namespaces</h3></div></div></div><p>Currently the PACKET namespace is reserved for information contained in an incoming MGEN packet. Information supported in the PACKET namespace includes:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"> PACKET:SRCIP - Source ip address as defined by the MGEN source field </li><li class="listitem"> PACKET:SRCPORT - Source port as defined by MGEN source field </li><li class="listitem"> PACKET:DSTIP - Destination IP of the MGEN packet </li><li class="listitem"> PACKET:DSTPORT - Destination Port of the MGEN packet </li><li class="listitem"> PACKET:SEED - Random seed stored in the RAPR packet payload </li></ul></div><pre class="programlisting">DECLARATIVE UDP SRC 5000 DST %PACKET:SRCIP%/%PACKET:SRCPORT% PERIODIC [1 2048]
</pre><p>The SYSTEM namespace keyword should be used to access the RANDOMI(n,n) and RANDOMF(n,n,[z]) functions. These functions will return a random integer or a random float value within a specified range. In the RANDOMF function, z is an optional argument and specifies the number of decimal places the float should have. By default, 1 decimal place is generated. For example, the functions at the beginning of a declarative declaration:</p><pre class="programlisting">%SYSTEM:RANDOMI(5,10)% DECLARATIVE UDP SRC ...
%SYSTEM:RANDOMF(5,10,1)% DECLARATIVE UDP SRC ...
</pre><p>would result in a start time between 5 and 10 seconds. The SEED associated with the triggering event will be used to seed the random number generator used by the random function.</p><p>The SystemNamespace namespace is reserved for application wide defaults.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e975"></a>11.7.&nbsp;Default Dictionary and Default System Values</h3></div></div></div><p>The RAPR application provides certain application wide default values. In addition, a "default" dictionary is provided in the RAPR distribution that can be used to override these application wide default values. If no default dictionary is loaded into a running RAPR application via a "LOAD_DICTIONARY" command RAPR will default to using the values as specified in the table below. The "dictionary Field" columns lists the dictionary field names that <span class="emphasis"><em>must</em></span> be used in the DEFAULT system name space. The "system value" lists the internal application wide default that can be overridden in the default dictionary.</p><div class="table"><a name="d0e983"></a><p class="title"><b>Table&nbsp;2.&nbsp;Default Dictionary</b></p><div class="table-contents"><table summary="Default Dictionary" border="1"><colgroup><col width="33%"><col width="33%"><col width="34%"></colgroup><thead><tr><th align="center">Dictionary Field</th><th align="center">System Value</th><th align="center">Comments</th></tr></thead><tbody><tr><td>RETRYINTERVAL</td><td>10</td><td>The default retry interval used by an interrogative object if no RETRYINTERVAL attribute is specified.</td></tr><tr><td>NUMRETRIES</td><td>3</td><td>The default number of retries used by an interrogative object if no NUMRETRIES attribute is specified.</td></tr><tr><td>PATTERN</td><td>PERIODIC [1 1024]</td><td>The default mgen flow pattern that is used for all behavior events when no PATTERN is specified.</td></tr><tr><td>STREAMDURATION</td><td>.99</td><td>The default stream duration that is used by the interrogative object for each message query or as the default duration for declarative objects. See the object definitions for more details on how this interval is used/calculated.</td></tr><tr><td>PROTOCOL</td><td>UDP*</td><td>The default protocol to be used by all behavior events. Note that this default can <span class="emphasis"><em>only</em></span> be set in the default dictionary. No internal default PROTOCOL is set system wide. If no entry is set specified in the default dictionary, the PROTOCOL <span class="emphasis"><em>must</em></span> be set on the command line for each behavior event.</td></tr></tbody></table></div></div><br class="table-break"><p>In the default distribution, the default dictionary <code class="literal">raprDictionary.xml</code> is located in the rapr/unix directory. By default, the SystemNamespace in this dictionary specifies all the attributes listed above. Note that these are the same values that will be used by the system even if NO default dictionary is loaded. The following is an example of a default dictionary with only the default protocol and the number of retries specified. All other defaults will revert to those specified internally by the application.</p><pre class="programlisting">&lt;RaprDictionary&gt;
    &lt;namespace&gt;
    &lt;label&gt;SystemNamespace&lt;/label&gt;
        &lt;!-- Application wide defaults --&gt;
        &lt;item&gt;
            &lt;!-- Default number of retries for interrogative events --&gt;
            &lt;field&gt;NUMRETRIES&lt;/field&gt;
            &lt;value&gt;5&lt;/value&gt;
        &lt;/item&gt;

        &lt;item&gt;
            &lt;!-- Default protocol for all events --&gt;
            &lt;field&gt;PROTOCOL&lt;/field&gt;
            &lt;value&gt;UDP&lt;/value&gt;
        &lt;/item&gt;
    &lt;/namespace&gt;
&lt;/RaprDictionary&gt;
</pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_input_script"></a>12.&nbsp;RAPR Input Script Format</h2></div></div></div><p>RAPR scripts are text files containing a sequence of commands and scheduled events describing traffic generation patterns, ports and/or multicast groups to be monitored, and other options. Each line in the script corresponds to either a <a class="link" href="#_Rapr_Events" title="14.&nbsp;Rapr Events and Global Commands">RAPR Event</a> (note that many RAPR Events are <a class="link" href="#_GLOBAL" title="14.2.&nbsp;Global Commands">Global Events)</a>, or a <a class="link" href="#">Reception Event</a> , or a <a class="link" href="#">Behavior Event</a>. Lengthy script lines can be continued to multiple text file lines by using a trailing backslash '\' character at the end of the line. Additionally, blank lines are permitted and comment lines can be included by providing a leading '#' character at the beginning of lines. (Note comment lines cannot be inserted in between "continued" script lines).</p><p>Scheduled events in the script use lines in the format of:</p><pre class="programlisting">
[&lt;eventTime&gt;] &lt;eventType&gt; &lt;parameters ...&gt; [&lt;options...&gt;] 
</pre><p>These "events" are scheduled to be executed by RAPR at the relative time given by the &lt;eventTime&gt; field. The value of this field is a floating point number which denotes the relative time (in seconds) of the associated event. The time is relative to the start of the RAPR program or the time dictated by the <a class="link" href="#_GLOBAL" title="14.2.&nbsp;Global Commands">global</a> START command. If the &lt;eventTime&gt; is omitted, an &lt;eventTime&gt; of 0.0 (or immediately if RAPR is already started) is assumed. <a class="link" href="#_Rapr_Events" title="14.&nbsp;Rapr Events and Global Commands">RAPR Event</a> (or <a class="link" href="#_GLOBAL" title="14.2.&nbsp;Global Commands">global commands</a>) are generally used to define default behaviors for RAPR operation or other options independent of event scheduling.</p><p>The format for global command script lines is: &lt;commandType&gt; [&lt;command parameters ...&gt;]</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_Behavior_events"></a>13.&nbsp;Behavior Events</h2></div></div></div><p>RAPR "Behavior Event" script lines are used to schedule and characterize RAPR traffic generation. An instance of RAPR can simultaneously transmit traffic to multiple destinations with different patterns of transmission. The three main types of behavior events are <a class="link" href="#_declarative" title="13.1.&nbsp;Declarative Event">Declarative</a>, <a class="link" href="#_interrogative" title="13.2.&nbsp;Interrogative Event">Interrogative</a>, and <a class="link" href="#_stream" title="13.3.&nbsp;Stream Event">Stream</a> events.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_declarative"></a>13.1.&nbsp;Declarative Event</h3></div></div></div><p>Script syntax:</p><pre class="programlisting">
[&lt;eventTime&gt;] [STOP &lt;0.0&gt; | DURATION &lt;0.0&gt;] [RAPRFLOWID &lt;raprFlowId&gt;] 
     DECLARATIVE &lt;protocol&gt; 
     [SRC &lt;srcPort&gt;] 
     DST &lt;dst-ip&gt;/&lt;dstPort&gt; [&lt;validMgenPattern [params]&gt;] 
     [SUCCESS &lt;success_logid_id&gt;] [FAILURE &lt;failure_logic_id&gt;] 
     [PAYLOAD|LOGICID &lt;payload_logic_id&gt;] [TIMEOUT &lt;timeout_logic_id&gt;] 
     [TTL &lt;timetolivevalue&gt;] [TOS &lt;tos&gt;] 
</pre><p>The DECLARATIVE keyword directs RAPR to create a behavior event that starts either a UDP or a TCP flow to a unicast or multicast destination for a given duration and does not expect a response. At the specified (or implied) end time it stops the flow.</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1101"></a>13.1.1.&nbsp;STOP, DURATION, and COUNT attributes.</h4></div></div></div><p>The STOP attribute means stop the event (in this instance, meaning the mgen flow initiated by the specified mgen pattern) at time relative to start time. E.g. if event start time offset was 5.0, a STOP 10.0 would stop the event at 10 seconds relative to test start time.</p><p>Conversely, the DURATION attribute specifies the duration of the event regardless of start offset time. E.g. if the event start offset was 5.0, a DURATION 10.0 would stop the event after 10 seconds, at 15 seconds relative to test start time.</p><p>If no STOP or DURATION is specified, COUNT will default to 1 and one message will be sent. If a COUNT <span class="emphasis"><em>is </em></span>specified but no STOP nor DURATION is, the behavior will stop after COUNT * pattern interval. If both COUNT and a STOP or DURATION is specified, the first limit to be reached will stop the flow.</p><p>Finally, if either STOP or DURATION is set to -1.0 no stop time will be set for the flow and the flow will continue indefinately unless the flow is subseqently stopped via a RAPRFLOWID command or the RAPR</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1115"></a>13.1.2.&nbsp;Infinite data flows.</h4></div></div></div><p>If either STOP or DURATION is set to -1.0 no stop time will be set for the flow and the flow will continue indefinately unless the flow is subseqently stopped via a RAPRFLOWID command or the RAPR</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1120"></a>13.1.3.&nbsp;RAPRFLOWID</h4></div></div></div><p>The optional &lt;RAPRFLOWID&gt; is used to identify the flow within the script and can be used by a subsequent <a class="link" href="#">STOP</a> event to stop the flow initiated here.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1128"></a>13.1.4.&nbsp;SRC, DST, and PATTERN attributes</h4></div></div></div><p>The SRC &lt;srcPort&gt;, DST &lt;dstIP&gt;/&lt;dstPort&gt;, and mgen PATTERN [&lt;pattern&gt;] attributes are passed through to the MGEN engine. (See <a class="ulink" href="http://www.nrl.navy.mil/itd/ncs/products/mgen" target="_top">MGEN</a> and <a class="link" href="#_Behavior_Event_Options" title="13.5.&nbsp;Behavior Event Options">behavior event options</a> for additional details on specifying MGEN patterns and these attributes). In general however, the &lt;protocol&gt; field indicates the transport protocol to be used for the generated RAPR test messages.</p><p>Current supported &lt;protocol&gt; types include "UDP" and "TCP". The "UDP" protocol type encapsulates generated RAPR messages for the flow into UDP/IP packets and transmits them over the network. The "TCP" protocol type encapsulates generated RAPR messages for the flow into TCP/IP packets and transmits them over the network. Note that the destination node must be listening for incoming TCP traffic on the specified port. The flow destination address and port must be specified using the DST option and the &lt;pattern&gt; of message generation must be given as well. Other flow options may be specified to further characterize the flow. See <a class="ulink" href="http://www.nrl.navy.mil/itd/ncs/products/mgen" target="_top">MGEN</a> and <a class="link" href="#_Behavior_Event_Options" title="13.5.&nbsp;Behavior Event Options">behavior event options</a> for additional information on defining MGEN flow characteristics such as TOS and TTL and traffic pattern definitions.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1147"></a>13.1.5.&nbsp;LOGICID, SUCCESS, FAILURE, TIMEOUT, PAYLOAD.</h4></div></div></div><p>The SUCCESS, FAILURE, TIMEOUT, and PAYLOAD|LOGICID logic id's direct the application behavior upon the specified event. (PAYLOAD and LOGICID are synonyms and can be used interchangeably to direct what RAPR puts in the message payload field). For DECLARATIVE objects, only the SUCCESS and LOGICID|PAYLOAD logic id's have any real meaning. After the event stops (e.g. the mgen flow is turned off) any specified success id will direct RAPR to perform the behavior specified in the <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a> associated with the SUCCESS logic ID. The PAYLOAD logic id (if specified) will be placed in the outgoing mgen message payload to direct the target node's behavior response to the message(s).</p><p>Examples:</p><p>The simplest declarative command can be written:</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1159"></a>13.1.6.&nbsp;Examples</h4></div></div></div><pre class="programlisting">DECLARTIVE DST 192.168.1.100/6000</pre><p>This will start a declarative command immediately, direct the system to provide a src port, default the flow pattern to "PERIODIC [1 1024]", default the COUNT attribute to 1 such that one message will be sent, and turn the flow off after that. No logic id will be sent in the payload. (Note that if PROTOCOL is not defined in the default dictionary PROTOCOL UDP must be specified in the command).</p><p>This script line will originate a "flow" of RAPR UDP destined for the loopback address (IP address 127.0.0.1) port number 5000 beginning immediately when the script is executed. The messages will consist of 1024 byte messages at a regular rate of 1.0 per second: </p><pre class="programlisting">
0.0 DECLARATIVE UDP SRC 5001 DST 127.0.0.1/5000 PERIODIC [1.0 1024]
</pre><p>In this example, no start time is specified so the event will take place immediately. No STOP time specified indicates to RAPR that a single message should be sent. Upon behavior completion, the SUCCESS logic ID directs RAPR to perform the behavior in the <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a> associated with SUCCESS id 1. </p><pre class="programlisting">
DECLARATIVE UDP SRC 5000 DST 192.168.1.100/5000 PERIODIC [1 1024] SUCCESS 1
</pre><p>This command tarts a UDP flow immediately. Stops flow 10.0 seconds into the test relative to RAPR time. Mgen pattern is BURST [REGULAR 10.0 PERIODIC [10.0 256] FIXED 5.0] All UDP messages will include a PAYLOAD logic id of 1. </p><pre class="programlisting">
0.0 STOP 10.0 DECLARATIVE UDP SRC 5005 DST
192.168.1.100/5005 BURST [REGULAR 10.0 PERIODIC [10.0 256] FIXED 5.0]
LOGICID 1 
</pre><p>At 15.0 into test, send a single 5 Meg TCP message.</p><pre class="programlisting">
15.0 DECLARATIVE TCP SRC 5000 DST 192.168.1.100/5001 [1 5242880] 
#  Declaratives can also be used to trigger an mgen multicast flow
DECLARATIVE UDP SRC  TXBUFFER 2000 DST 224.225.1.2/5001 POISSON [1 4096] 
</pre><p>DICTIONARY TRANSLATIONS: Enclose entries in the dictionary in "%"'s, e.g. %%. In this example, CMDR1 is translated into a RAPR dictionary value (script entries only, not implemented over run time interface yet.) </p><pre class="programlisting">
DECLARATIVE UDP SRC 5000 DST %CMDR1%/5000 PERIODIC [1 1024] 
</pre><p>Mgen pattern is translated into a RAPR dictionary value (script entries only, not implemented over run time interface yet.) </p><pre class="programlisting">
   DECLARATIVE UDP SRC 5000 DST 192.168.1.100/5000 %FLOW_PATTERN_1% 
</pre></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_interrogative"></a>13.2.&nbsp;Interrogative Event</h3></div></div></div><p>Script syntax:</p><pre class="programlisting">
[&lt;0.0&gt;] [STOP &lt;0.0&gt; | DURATION &lt;0.0&gt;] INTERROGATIVE &lt;protocol&gt; 
     RETRYINTERVAL &lt;retry_interval&gt; 
     NUMRETRIES &lt;#_retries&gt; 
     SRC &lt;srcport&gt; 
     DST &lt;dst-ip&gt;/&lt;dstport&gt; &lt;valid mgen pattern&gt; [COUNT &lt;cnt&gt;]
     [SUCCESS &lt;success_logic_id&gt;] [FAILURE &lt;failure_logic_id&gt;] 
     [PAYLOAD|LOGICID &lt;payload_logic_id&gt;] [TIMEOUT &lt;timeout_logic_id&gt;] 
     [TTL &lt;timetolivevalue&gt;] [TOS &lt;tos&gt;] </pre><p>An INTERROGATIVE event sends a single UDP or TCP message or a limited mgen flow (as defined by the PATTERN and/or COUNT attributes) and waits for a response. If it gets a response from the destination, the behavior is considered successful, otherwise not. An INTERROGATIVE behavior event can be told to RETRY the behavior N times, at RETRYINTERVALS of N, before terminating the behavior. See the <a class="link" href="#_declarative" title="13.1.&nbsp;Declarative Event">declarative</a> event definition or <a class="link" href="#_Behavior_Event_Options" title="13.5.&nbsp;Behavior Event Options">behavior event options</a> for details on attributes not detailed here.</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1208"></a>13.2.1.&nbsp;RETRYINTERVAL and NUMRETRIES</h4></div></div></div><p>The RETRYINTERVAL specifies the amount of time to wait before sending a subsequent message if a response has not been received from the destination. NUMRETRIES specifies how many messages (or limited mgen flows) to send to illicit a response from the destination. If no behavior end time is specified, the event will time out after the number of retries plus one, multiplied by the retry interval.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1213"></a>13.2.2.&nbsp;Stream Duration and COUNT</h4></div></div></div><p>Unless the STREAMDURATION attribute is overridden in the <a class="link" href="#">default dictionary</a>, the default stream duration will be set to 0.99 seconds. This means that there will be a one second window within which to send the specified pattern of messages, e.g. given a pattern of [10 1024] 10 1024 bytes messages will be sent for each interrogative "message"; given a pattern of [1 1024] 1 1024 byte message will be sent.</p><p>If a COUNT attribute is specified, the STREAMDURATION (the time within which the event can send COUNT messages) will be set to the RETRYINTERVAL. If the retry interval expires before COUNT messages have been sent, the flow will be turned off at retry interval and another "retry" of a second set of COUNT messages will be made.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1223"></a>13.2.3.&nbsp;Logic Id's</h4></div></div></div><p>The FAILURE logic id, if specified, will direct RAPR to perform the behavior specified in the <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a> if a response is not received from the destination before the object times out (as dictated by the STOP/DURATION attributes. If a message was received from the destination within the time alloted, the SUCCESS logic id, if specified, will direct RAPR to perform the behavior specified in the <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1234"></a>13.2.4.&nbsp;Examples</h4></div></div></div><p>Examples:</p><p>The simplest interrogative event can be declared as follows:</p><pre class="programlisting">INTERROGATIVE DST 192.168.1.100/5001 LOGICID 1</pre><p>This will cause RAPR to start an interrogative object using the application defaults:</p><pre class="programlisting">0.0 STOP 30.0 INTERROGATIVE RETRYINTERVAL 10.0 NUMRETRIES 3 UDP |
SRC &lt;systemProvided&gt; DST 192.168.1.100/50001 \
PERIODIC [1 1024] COUNT 1</pre><p>The behavior sill start immediately and one 1024 byte UDP message will be sent to the destination. The behavior will be repeated every 10 seconds. If no response has been received from the destination after 4 attempts, the behavior will terminate in a failure condition. If a response is received the behavior will be considered successful and no further messages will be sent.</p><p>The following command will start an INTERROGATIVE message immediately, sending a single UDP message to the destination. After 5 seconds, if a response has not been received, it will send a 2nd, 3rd, and 4th. If after 60 seconds, no response has been received to any of the messages, the object will "timeout" and any timeout and/or the failure logic IDs will be evaluated. In this case, a failure logic id of "5" has been associated with the object, so the object will invoke the behavior in the logic table associated with logic id 5. If the object HAD received a response, after say, 2 messages had been sent, the behavior object would "succeed" and no further action will have been taken since the "success" logic id in this example is 0. </p><pre class="programlisting">
STOP 60.0 INTERROGATIVE RETRYINTERVAL 5.0 NUMRETRIES 3 UDP SRC 5000 \
DST 192.168.1.100/5001 PERIODIC [1 1024] COUNT 1 FAILURE 5
</pre><p>Assuming no changes have ben made to the default dictionary, the following example will send 5 1024 byte TCP messages and one second intervals to the destination. If no reply has been received after 10 seconds, another burst of 5 tcp messages will be sent and so on until the behavior either fails or a successful response has been received. </p><pre class="programlisting">INTERROGATIVE TCP DST 192.168.1.100/5000 COUNT 5 </pre></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_stream"></a>13.3.&nbsp;Stream Event</h3></div></div></div><pre class="programlisting">
Script syntax:
[&lt;eventTime&gt;] [DURATION &lt;duration&gt;] STREAM 
     <a class="link" href="#_RESPPROB" title="13.3.1.&nbsp;RESPPROB">RESPPROB</a> &lt;lowRange&gt; &lt;highRange&gt; 
     [<a class="link" href="#_BURSTPRIORITY" title="13.3.7.&nbsp;BURSTPRIORITY">BURSTPRIORITY</a> &lt;burstPriority&gt;] 
     [<a class="link" href="#_BURSTDURATION" title="13.3.2.&nbsp;BURSTDURATION">BURSTDURATION</a> &lt;burstDuration&gt;] 
     [<a class="link" href="#_BURSTCOUNT" title="13.3.3.&nbsp;BURSTCOUNT">BURSTCOUNT</a> &lt;burstCount&gt;] 
     [<a class="link" href="#_BURSTDELAY" title="13.3.4.&nbsp;BURSTDELAY">BURSTDELAY</a> &lt;lowDelay&gt; &lt;highDelay&gt;] 
     [<a class="link" href="#_BURSTRANGE" title="13.3.5.&nbsp;BURSTRANGE">BURSTRANGE</a> &lt;lowRange&gt; &lt;highRange&gt;] 
     [<a class="link" href="#_TIMEOUTINTERVAL" title="13.3.6.&nbsp;TIMEOUTINTERVAL">TIMEOUTINTERVAL</a> &lt;timeoutInterval&gt;]&lt;
     PROTOCOL&gt; 
     SRC &lt;srcPort&gt; 
     DST &lt;dstIP&gt;/&lt;dstPort&gt; &lt;mgenPattern&gt; 
     [PAYLOAD|LOGICID &lt;payloadLogicId&gt;] 
</pre><p>Stream behavior events can be used to emulate Voice Over IP traffic characteristics. The simplest emulation is a "group chat" configuration. In this setup, a set of nodes are elected to participate in a VOIP group "conversation". One node must be elected to initiate the "conversation" and should do so by a scripted STREAM event in its <a class="link" href="#_input_script" title="12.&nbsp;RAPR Input Script Format">input script</a> file. Other participating nodes must be configured to respond to the initiating node by having response STREAM behaviors defined in their <a class="link" href="#">behavior tables</a>. The initiating STREAM event must be defined to send a PAYLOAD logic id in its outgoing messages to trigger the response behavior(s). All participating nodes must <a class="link" href="#_JOIN" title="13.6.2.&nbsp;JOIN">JOIN</a> and <a class="link" href="#_LISTEN" title="13.6.1.&nbsp;LISTEN">LISTEN</a> to a common multicast group.</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_RESPPROB"></a>13.3.1.&nbsp;RESPPROB</h4></div></div></div><p>Stream messages are sent with a seed that is used by the participating nodes to determine whether they should be the next node to respond to the "conversation". This incoming seed is used by all participating nodes to seed a random number generator. If the next random number draw falls within the response probability range (RESPPROB &lt;lowRange&gt; &lt;highRange&gt;) defined for a given node, the node will be the next to "speak" in the "conversation". Note that a triggering node may well be elected "next to respond". The response ranges should be equally distributed amongst all nodes participating in the "conversation" such that only one node can be elected to respond. For example, to set up a group conversation among four nodes each with an equal probability of reply, setup the RESPPROB attribute as follows:</p><pre class="programlisting">... STREAM RESPPROB 0 25 (node A)
... STREAM RESPPROB 26 50 (node B)
... STREAM RESPPROB 51 75 (node C)
... STREAM RESPPROB 76 100 (node D)
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_BURSTDURATION"></a>13.3.2.&nbsp;BURSTDURATION</h4></div></div></div><p>The BURSTDURATION attribute specifies the length in seconds of the node's reply to a "conversation". A reply can be thought of as a "burst". This setting may be superseded by the BURSTRANGE attribute.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_BURSTCOUNT"></a>13.3.3.&nbsp;BURSTCOUNT</h4></div></div></div><p>The BURSTCOUNT attribute defines the length of the "conversation". A triggering stream with a burst count of 5 will result in 5 "bursts" of conversation from any of the participating nodes.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_BURSTDELAY"></a>13.3.4.&nbsp;BURSTDELAY</h4></div></div></div><p>The BURSTDELAY attribute defines the range to be used to determine the number of seconds to wait before a node will respond to a "conversation" (if so elected based on its response probability). For example:</p><pre class="programlisting">... STREAM BURSTDELAY 1 3 ...
</pre><p>will cause the node to wait between one and three seconds before replying.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_BURSTRANGE"></a>13.3.5.&nbsp;BURSTRANGE</h4></div></div></div><p>The BURSTRANGE attribute defines the range to be used to determine the length of the next burst response in number of seconds (if so elected based on its response probability). Note that BURSTDURATION can also be used to specify the length of burst responses. For example:</p><pre class="programlisting">... STREAM BURSTRANGE 5 10 ...
</pre><p>will cause the node to send a burst response between 5 and 10 seconds.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_TIMEOUTINTERVAL"></a>13.3.6.&nbsp;TIMEOUTINTERVAL</h4></div></div></div><p>The TIMEOUTINTERVAL attribute defines the length of time (in seconds) that the stream event will wait for response traffic. If no response is received from ANY node participating in the conversation (including itself) within this timeout interval, the stream object will "timeout" and stop the stream event, and not respond to any further traffic associated with the stopped "conversation". For example:</p><pre class="programlisting">... STREAM TIMEOUTINTRERVAL 10  ...
</pre><p>will cause the stream event to timeout after 10 seconds.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_BURSTPRIORITY"></a>13.3.7.&nbsp;BURSTPRIORITY</h4></div></div></div><p>A BURSTPRIORITY can be assigned to STREAM events that will cause the "conversation" to take precedence over any other ongoing conversation. For example, if a conversation of default priority (0) is ongoing, and a second "conversation" is initiated at a higher priority, the higher priority conversation will be "served" before the lower priority conversation.</p><p>Note that a node can only be "responding" to a single VOIP "conversation" at a time. When the response is completed, the node is free to participate in other "conversations". If a node is participating in a lower priority "conversation", but is not in the act of "responding", the node is free to participate in the higher priority conversation. If however, the node was responding, or about to respond, to a lower priority conversation, the lower priority conversation will be "stopped" potentially causing the end of the first conversation. If enough packets have been received by the participating nodes to trigger the next "burst" of conversation however, this may not be the case. For example, Node X starts stream conversation 1, sequence # 1 (where node X refers to all the possible nodes participating in a group chat)</p><pre class="programlisting">        node X 1.1&gt; node B (node b responds to stream 1, w/burst 2)
                  &lt;1.2
                  &lt;1.2
                  &lt;1.2
</pre><p>Node C requests a higher priority conversation while node b is responding to conversation 1. Node B, stops stream 1.2 and responds to 2.1</p><pre class="programlisting">        node C 2.1&gt; node B 
                  &lt;OFF 1.2
                  &lt;2.2
                  &lt;2.2
        
        node C 2.3&gt; node B
               2.3&gt;
</pre><p>Meanwhile the node in conversation 1 that was chosen to respond to sequence 1.2 starts responding (because it received a triggering packet - given 0% packet loss, just a single packet will trigger the response. The responding node does not know, nor needs to know that node b has - perhaps temporarily - dropped out). Node B hears this traffic but is not elected to respond based on the probability of response. It will passively ignore this conversation and continue to respond to node C (assuming set up to direct this behavior in the stream configuration)</p><pre class="programlisting">        node X 1.3&gt; node B
                          (probability of response = false, do nothing)
        
                           node X.1 probability of response = true, responds
                  &lt;1.4 node X.1 
        
           node C &lt;2.4 node B
                  &lt;2.4             * conversation ends
</pre><p>Node X.1 responded to 1.3, and its 1.4 response will direct node b to respond. Because 1) node b is not speaking in any other conversations, and because 2) the conversation with node C is completed, node b "rejoins" conversation 1.</p><pre class="programlisting">        node X.1 1.4&gt; node B (probabiliyt of response = true, continue)
                    &lt;1.5
                    &lt;1.5
</pre><p>Note that if it was node B's turn to respond to 1.3 and node B is unable to do so due to the higher priority conversation, conversation 1 will end sooner than scheduled.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_periodic"></a>13.4.&nbsp;Periodic Event</h3></div></div></div><p>Script syntax:</p><pre class="programlisting">&lt;eventTime&gt;[STOP &lt;0.0&gt; | DURATION &lt;0.0&gt;] [RAPRFLOWID &lt;raprFlowId&gt;] 
     PERIODIC 
     <a class="link" href="#_INTERVAL" title="13.4.1.&nbsp;INTERVAL">INTERVAL</a> &lt;interval&gt; [EXP]
     <a class="link" href="#_DURATION" title="13.4.3.&nbsp;DURATION">DURATION</a> &lt;duration&gt; 
     &lt;<a class="link" href="#_description" title="13.4.4.&nbsp;Declarative/Interrogative Description">Declarative/Interrogative Description</a>&gt; 
</pre><p>Periodic Events can be used to spawn other behavior event types (Declarative and Interrogative only) at regular intervals. These generated behavior events behave as independent events and have no relationship to one another. In the following example, the event will start at time 0.0 in the timeline and spawn an initial DECLARATIVE event at time 0.0 that will send a single UDP message (e.g. timeout at time 0.01). After an 5 second interval, a second UDP message will start and timeout after 0.01. After 30 seconds, the periodic object will timeout after spawning six declarative objects at 5 second intervals.</p><pre class="programlisting">0.0 STOP 30.0 RAPRFLOWID 1 PERIODIC INTERVAL 5 DURATION 0.01 \
DECLARATIVE UDP SRC 5000 DST 192.168.1.102/5001 PERIODIC [1 1024]
</pre><p>In this example, the command would direct RAPR to start a PERIODICITY object associated with RAPRFLOWID "1" 15 seconds into the test and have it run for 15 seconds, kicking off the behavior at 5 second intervals. At 15 seconds into the test, an interrogative object would be created that behaves as a normal interrogative object would. The interrogative object would have a five second duration and send four messages at 1 second intervals before timing out after 5 seconds, if no response message has been received.</p><p>After 5 seconds (regardless of the state of the first "behavior" instantiated), the periodic object will instantiate a new interrogative object, and for 5 second intervals thereafter, up to the 15 second "timeout" period.</p><pre class="programlisting">15.0 STOP 30.0 RAPRFLOWID 1 PERIODIC INTERVAL 5 DURATION 5.0 
   INTERROGATIVE RETRYINTERVAL 1.0 NUMRETRIES 3 UDP SRC 5001 \
DST 192.168.1.102/5000 PERIODIC [1 1024] LOGICID 1 
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The periodicity object will retranslate its event definition for the object to be spawned each time a new object starts. The PERIODIC INTERVAL is also retranslated each time. For example, the following PERIODIC definition will send a single 1024 byte UDP packet to 192.168.1.102 every 5 to 10 seconds for 120 seconds.</p></div><pre class="programlisting">DURATION 120 PERIODIC INTERVAL %SYSTEM:RANDOMI(5,10)% DECLARATIVE \
UDP DST 192.168.1.102/6000</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Translations that would result in multiple objects being created will ~not~ be allowed. E.g.</p><p>STOP 30 PERIODIC INTERVAL 10 DECLARATIVE DST %DESTINATION% &lt;item&gt; &lt;field&gt;DESTINATION&lt;/field&gt; &lt;value&gt;192.168.1.102&lt;/value&gt; &lt;value&gt;192.168.1.103&lt;/value&gt; &lt;/item&gt; A warning message would be displayed that periodicity behavior definitions cannot result in multiple events being created.</p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Note that the STOP or DURATION attribute must be specified for periodic events and that the RAPRFLOWID attribute must follow the STOP OR DURATION attribute.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_INTERVAL"></a>13.4.1.&nbsp;INTERVAL</h4></div></div></div><p>The INTERVAL keyword specifies the interval at which new <a class="link" href="#_declarative" title="13.1.&nbsp;Declarative Event">declarative</a> or <a class="link" href="#_interrogative" title="13.2.&nbsp;Interrogative Event">interrogative</a> events should be instantiated. The first event will be spawned at the start time of the periodic object itself, the second after the INTERVAL has elapsed. Events will continue to be spawned at this regular interval until the periodic event times out or is stopped by a <a class="link" href="#_raprflowid" title="14.1.1.&nbsp;RAPRFLOWID">RAPRFLOWID</a> command.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1416"></a>13.4.2.&nbsp;EXP</h4></div></div></div><p>The EXP keyword directs RAPR to calculate the interval at which the periodic object spawns other events following a POISSON distribution, or at an exponentially distributed interval. Note that this may cause object/traffic overlap should the calculated spawning interval be smaller that the spawned object(s) duration(s).</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_DURATION"></a>13.4.3.&nbsp;DURATION</h4></div></div></div><p>The DURATION command specifies the duration of the spawned events. STOP is not a valid attribute for the spawned events.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_description"></a>13.4.4.&nbsp;Declarative/Interrogative Description</h4></div></div></div><p>See <a class="link" href="#_declarative" title="13.1.&nbsp;Declarative Event">declarative</a> and <a class="link" href="#_interrogative" title="13.2.&nbsp;Interrogative Event">interrogative</a> events for the required patterns. Note that STOP is not a valid attribute when these events are to be triggered by a Periodic event.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Behavior_Event_Options"></a>13.5.&nbsp;Behavior Event Options</h3></div></div></div><p>This section describes options which may be applied to <a class="link" href="#">behavior</a> events in RAPR script files. Note that transmission events (e.g. DECLARATIVE, INTERROGATIVE, and STREAM events) require specification of at least the &lt;protocol&gt;, &lt;destination&gt;, and &lt;pattern&gt; options.</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Protocol__UDP"></a>13.5.1.&nbsp;Protocol (UDP)</h4></div></div></div><p><code class="literal"> Option syntax: ... &lt;protocolType&gt; ... </code> The transport protocol for RAPR messages generated by a flow must be specified as part of any events. Example:</p><pre class="programlisting">DECLARATIVE UDP DST 127.0.0.1/5000 PERIODIC [1.0 1024] </pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_Destination__DST"></a>13.5.2.&nbsp;Destination (DST)</h4></div></div></div><p><code class="literal"> Option syntax: ... DST &lt;addr&gt;/&lt;port&gt; ... </code> The destination address for a flow must be specified. The &lt;addr&gt; field specifies the destination IP address (IPv4 or IPv6) and the &lt;port&gt; field specifies the destination host port number. The destination address may be a unicast (point-to-point) or multicast address. Examples:</p><pre class="programlisting">#Start a flow to loopback address
port 50000.0 DECLARATIVE UDP DST 127.0.0.1/5000 PERIODIC [1.0 1024]
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_Source_Port__SRC"></a>13.5.3.&nbsp;Source Port (SRC)</h4></div></div></div><p><code class="literal"> Option syntax: ... SRC &lt;port&gt; ... </code> The source port number used for generated traffic may be optionally specified. The &lt;port&gt; field identifies the host port number to be used. When the SRC option is not specified, the flow will use a free port number picked by the operating system. Note that RAPR UDP flows may share the same source port and the associated flow will "inherit" some attributes (e.g. <a class="link" href="#">TOS</a>, <a class="link" href="#">TTL</a>, etc) which may have been set for other flows which use that same source port. This is because some of these attributes tend to be maintained by operating systems on a "per socket" basis. Also, any such attributes set for this flow will affect other existing flows using the same source port. Thus, the SRC option is useful when it is desired to explicitly create different flows with distinct "per socket" attributes such as <a class="link" href="#">TOS</a> or multicast <a class="link" href="#">TTL</a>.</p><p>Example: Here, two flows are created with the same destination address, but different source ports. Flow 1 is also assigned non-default type-of-service using the <a class="link" href="#">TOS</a> option. The use of the SRC option ensures that two different sockets are used to support the two different types of service.</p><pre class="programlisting"><code class="literal">
#Start flow 1 using source port 5001(TOS = 0x10) 
#and flow 2 using port 5002 
0.0 DECLARATIVE UDP DST 127.0.0.1/5000 SRC 5001 PERIODIC [1.0 1024] TOS \
0x100.0 
DECLARATIVE UDP DST 127.0.0.1/5000 SRC 5002 PERIODIC [10.0 512] 
</code>
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Pattern__PERIODIC,_POISSON,_BURST"></a>13.5.4.&nbsp;Pattern (PERIODIC, POISSON, BURST)</h4></div></div></div><p><code class="literal"> Option syntax: ... &lt;patternType&gt; [parameters ...] ... </code> (Note: The '[' and ']' characters are explicitly required at the beginning and end of the pattern parameter set. Different pattern types may use different parameter sets.) Traffic generated by RAPR consists of a series of sequence-numbered messages. The messaging generated by RAPR may vary in size and frequency of transmission to stress the network in a controlled fashion. The "Pattern" of message generation must be specified. Currently RAPR/MGEN supports three pattern types, "PERIODIC", "POISSON", and "BURST". Complex traffic patterns can be created by using a compound of multiple "flows" (with the same <a class="link" href="#">SRC</a>/<a class="link" href="#">DST</a>) with different pattern types and parameters. Other pattern types (e.g. MARKOV), including ones with statistically varying payload sizes, will be added eventually.</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="PERIODIC_Pattern"></a>13.5.4.1.&nbsp;PERIODIC Pattern:</h5></div></div></div><p><code class="literal"> Option syntax: ... PERIODIC [&lt;rate&gt; &lt;size&gt;] ... </code> This pattern type generates messages of a fixed &lt;size&gt; (in bytes) at a very regular &lt;rate&gt; (in messages/second). The &lt;size&gt; field must be greater or equal to the minimum RAPR message size and less than or equal to the maximum UDP message size of 8192 bytes. When other transport support is added (e.g. TCP), the message &lt;rate&gt; and &lt;size&gt; parameters will have additional flexibility as appropriate. Note the &lt;rate&gt; must be greater than or equal to 0.0 messages/second. Example:</p><pre class="programlisting">
#Start an RAPR flow sending 1024 byte messages 
#at a rate of 10.0 per second 
0.0 DECLARATIVE UDP DST 127.0.0.1/5000 PERIODIC [10.0 1024] 
#Reduce the flow rate to one 512 byte message
#every 2.0 seconds 
0.0 DECLARATIVE PERIODIC [0.5 512]
</pre></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="POISSON_Pattern"></a>13.5.4.2.&nbsp;POISSON Pattern:</h5></div></div></div><p><code class="literal"> Option syntax: ... POISSON [&lt;aveRate (msg/sec)&gt; &lt;size (bytes)&gt;] ... </code> This pattern type generates messages of a fixed &lt;size&gt; (in bytes) at statistically varying intervals at an average &lt;rate&gt; (in messages/second). The &lt;size&gt; field must be greater or equal to the minimum RAPR message size and less than or equal to the maximum UDP message size of 8192 bytes. When other transport support is added (e.g. TCP), the message &lt;aveRate&gt; and &lt;size&gt; parameters will have additional flexibility as appropriate. Note the &lt;rate&gt; must be greater than or equal to 0.0 messages/second. Example:</p><pre class="programlisting">#Start an RAPR flow sending 1024 byte messages 
#at an average rate of 10.0 per second 
0.0 DECLARATIVE UDP DST 127.0.0.1/5000
POISSON [10.0 1024] #Reduce the flow rate to an average of one 
#512 byte message every 2.0 seconds 
0.0 DECLARATIVE POISSON [0.5 512]
</pre></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="_BURST_pattern"></a>13.5.4.3.&nbsp;BURST Pattern:</h5></div></div></div><p><code class="literal"> Option syntax: ... BURST [REGULAR|RANDOM &lt;aveInterval (sec)&gt; &lt;patternType&gt; [&lt;patternParams&gt;] FIXED|EXPONENTIAL &lt;aveDuration (sec)&gt;] ... </code> The BURST pattern generates bursts of other RAPR pattern types at a specified average interval. The first parameter of the BURST pattern is either "REGULAR" resulting in periodic burst uniformly distributed in time by the &lt;aveInterval&gt; value, or "RANDOM" which exponentially distributes the traffic generation bursts in time with an average burst interval as specified by the &lt;aveInterval&gt; parameter value.</p><p>The characteristics of the RAPR messages generated during a burst is given by the &lt;patternType&gt; and associated &lt;patternParams&gt; parameters. The &lt;patternType&gt; may any RAPR pattern type including PERIODIC, POISSON, or, yes, even BURST. The &lt;patternParams&gt; must be appropriate for the given &lt;patternType&gt;.</p><p>When a traffic generation burst occurs, its duration is either of a FIXED value as given by the &lt;aveDuration&gt; or a randomly varying duration with EXPONENTIAL statistics and an average duration as given by the &lt;aveDuration&gt; parameter.</p><p>An example use of the BURST pattern would be to roughly emulate the "talk spurts" which might result from Voice Over IP (VOIP) applications. As a voice conversation commences, a user's burst of activity (talk spurts) might be RANDOM with some average interval and the duration of the talk spurts might approximate EXPONENTIAL statistics. When the talk spurt (burst) occurs, the voice compression codec might generate messages following something like a PERIODIC flow with packet rates and packet sizes dependent upon the voice codec in use.</p><p>Other uses of the BURST pattern might be to roughly model message/packet generation occurring with random use of a network such as web browsing, etc. The BURST model provided by RAPR does not presuppose any specific traffic model, but might be useful in approximating some models of regular or intermittent network activity. The average traffic generation rate for this pattern should be approximately the average transmission rate of the core &lt;patternType&gt; and &lt;patternParams&gt; multiplied by the burst duty cycle (&lt;aveDuration&gt; / &lt;aveInterval&gt;). Note that when average burst duration tends to exceed the average burst interval, the flow will tend to follow the characteristics of the core pattern (i.e. 100% duty cycle).</p><p>Example:</p><pre class="programlisting">#Start a bursty RAPR flow with bursts of 1024 byte messages 
#with a periodic rate of 10.0 messages per second.  The 
#bursts will occur at random intervals with an average 
#interval from the start of one burst until the start of 
#the next of 10.0 seconds.  The duration of each burst is
#of exponential statistics with an average burst duration 
#of 5.0 seconds.  
0.0 DECLARATIVE UDP DST 127.0.0.1/5000 BURST [RANDOM 10.0 \
PERIODIC [10.0 1024] EXP 5.0] </pre></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_Destination__DST"></a>13.5.5.&nbsp;Count</h4></div></div></div><p><code class="literal">Option syntax: ... COUNT &lt;cnt&gt; ... </code> The optional COUNT attribute specifies the number of messages that are to be sent for the event, e.g. a COUNT value of 1 means that one and only one mgen message will be sent. If no stop time is specified, COUNT attribute is defaulted to a value of 1.</p><p>Example:</p><pre class="programlisting"># Start a declarative message and send 3 messages before exiting
# according to the specified pattern:
DECLARATIVE DST 127.0.0.1/5000 PERIODIC [1 1024] COUNT 3 </pre><p>To send 5 messages every 2 seconds:</p><pre class="programlisting">declarative UPD src 5000 dst 192.168.1.100/6000 \
PERIODIC [.5 512] COUNT 5</pre><p>Note that if both COUNT and an event STOP time are provided, whichever parameter stops the flow soonest will win out. E.g. if COUNT packets are sent before the STOP event is processed, the flow will be stopped; if the STOP time is reached before COUNT packets are sent, the flow will be stopped.</p><pre class="programlisting"># This declarative behavior event flow will be stopped after
# five seconds
STOP 5.0 DECLARATIVE DST 127.0.0.1/6000 PERIODIC [1 1024] COUNT 10

# This declarative behavior event flow will be stopped after
# 5 packets have been sent
STOP 10.0 DECLARATIVE DST 127.0.0.1/6000 PERIODIC [1 1024] COUNT 5
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Type-Of-Service__TOS"></a>13.5.6.&nbsp;Type-Of-Service (TOS)</h4></div></div></div><p><code class="literal"> Option syntax: ... TOS &lt;value&gt; ... </code> The IP TOS (type-of-service) field can be controlled for IP packets associated with RAPR traffic generation. The &lt;value&gt; field specifies the value of the 8-bit TOS field in IPv4 packets. (IPv6 packets do not have a TOS field. RAPR will soon support control of the similar FLOW_ID field for IPv6 operation.) The &lt;value&gt; field must be in the range of 0-255 in decimal or hexadecimal notation.</p><p>The interpretation of the TOS value by different computer operating systems and network devices may vary. In some cases, computer hosts will not allow all possible values to be used, and in others "super user" (root) privileges may be required to set the IP TOS field to certain values.</p><p>Below are some notes on suggested interpretation by the Internet Engineering Task Force (IETF). Note that TOS is maintained on a "per socket" basis and that setting the TOS for a flow will affect other flows sharing the same network socket. See the <a class="link" href="#">SRC</a> option to make sure different flows use different sockets.</p><p>Example:</p><pre class="programlisting">#Start flow 1 with default TOS 
0.0 ON 1 UDP DST 127.0.0.1/5000 PERIODIC [1.0 1024] 

#Modify flow 1 to TOS = 0x10 (low delay) 
5.0 MOD 1 TOS 0x10 </pre><pre class="programlisting"> 
 
<code class="literal">   0     1     2     3     4     5     6     7
+-----+-----+-----+-----+-----+-----+-----+-----+ 
|   PRECEDENCE    | TOS |         MBZ           | 
+-----+-----+-----+-----+-----+-----+-----+-----+ 
</code>
</pre><p>The Type-of-Service byte in the IP header is divided into three sections: the Precedence field (high-order 3 bits), a field that is called Type of Service or TOS (next 4 bits), and a reserved bit (the low order bit). The TOS bits can be set to 5 different settings including the default setting of 0000, while the PRECEDENCE can be set to 8 different setting including default 000. TOS definitions:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><tbody><tr><td>&nbsp;</td><td>IPTOS_TOS_MASKIPTOS_TOS(tos)</td><td>0x1E= ((tos) &amp; IPTOS_TOS_MASK)</td><td class="auto-generated">&nbsp;</td></tr><tr><td>1000 --</td><td>IP_TOS_LOWDELAY</td><td>0x10</td><td>TOS = 16</td></tr><tr><td>0100 --</td><td>IP_TOS_THROUGHPUT</td><td>0x08</td><td>TOS = 8</td></tr><tr><td>0010 --</td><td>IPTOS_RELIABILITY</td><td>0x04</td><td>TOS = 4</td></tr><tr><td>0001 --</td><td>IPTOS_LOWCOST</td><td>0x02</td><td>TOS = 2</td></tr><tr><td>0000 --</td><td>normal service</td><td>0x00</td><td>TOS = 0</td></tr></tbody></table></div><p>Precedence definitions:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><tbody><tr><td>111 --</td><td>IPTOS_PREC_MASKIPTOS_PREC(tos)</td><td>0xe0= ((tos) &amp; IPTOS_PREC_MASK)</td><td class="auto-generated">&nbsp;</td></tr><tr><td>111 --</td><td>IPTOS_PREC_NETCONTROL</td><td>0xe0</td><td>TOS = 224</td></tr><tr><td>110 --</td><td>IPTOS_PREC_INTERNETCONTROL</td><td>0xc0</td><td>TOS = 192</td></tr><tr><td>101 --</td><td>IPTOS_PREC_CRITIC_ECP</td><td>0xa0</td><td>TOS = 160</td></tr><tr><td>100 --</td><td>IPTOS_PREC_FLASHOVERRIDE</td><td>0x80</td><td>TOS = 128</td></tr><tr><td>011 --</td><td>IPTOS_PREC_FLASH</td><td>0x60</td><td>TOS = 96</td></tr><tr><td>010 --</td><td>IPTOS_PREC_IMMEDIATE</td><td>0x40</td><td>TOS = 64</td></tr><tr><td>001 --</td><td>IPTOS_PREC_PRIORITY</td><td>0x20</td><td>TOS = 32</td></tr><tr><td>000 --</td><td>IPTOS_PREC_ROUTINE</td><td>0x00</td><td>TOS = 0</td></tr></tbody></table></div><p>If TOS = 164 (or 0xa4), the Precedence would be IPTOS_PREC_CRITIC_ECP and the TOS would be IPTOS_RELIABILITY. The IP TOS field bits would be set as 10100100.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_Time-To-Live__TTL"></a>13.5.7.&nbsp;Multicast Time-To-Live (TTL)</h4></div></div></div><p><code class="literal"> Option syntax: ... TTL &lt;value&gt; ... </code> The time-to-live (TTL) hop count can be controlled for IP multicast traffic generated by RAPR. As with <a class="link" href="#">TOS</a>, this is generally a "per socket" attribute and care should be taken if it is desired to specify different TTL values for different RAPR flows. This can be accomplished by using different <a class="link" href="#">SRC</a> (source ports) for different RAPR flows. The &lt;value&gt; field must be in the range of 1-255. The default multicast TTL assumed by RAPR is 3. Example:</p><pre class="programlisting">#Start an IP multicast flow with a maximum hop count ttl = 2
0.0 ON 1 UDP DST 224.1.2.3/5000 PERIODIC [1.0 256] TTL 2
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_TXBUFFER"></a>13.5.8.&nbsp;Socket Transmit Buffer Size (TXBUFFER)</h4></div></div></div><p><code class="literal"> Option syntax: ... TXBUFFER &lt;txBufferSize&gt; ... </code> This option allows users to set the socket transmit buffer size to a value &Ograve;at least&Oacute; as large as &lt;txBufferSize&gt;. If &lt;txBufferSize&gt; is larger that the maximum allowed by the system, &lt;txBufferSize&gt; will be set to the system maximum. To date, this option has only been tested on linux systems.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Socket_Receive_Buffer_Size__RXBUFFER"></a>13.5.9.&nbsp;Socket Receive Buffer Size (RXBUFFER)</h4></div></div></div><p><code class="literal"> Option syntax: ... RXBUFFER &lt;rxBufferSize&gt; ... </code> This option allows users to set the socket receive buffer size to a value &Ograve;at least&Oacute; as large as &lt;rxBufferSize&gt;. If &lt;rxBufferSize&gt; is larger that the maximum allowed by the system, &lt;rxBufferSize&gt; will be set to the system maximum. To date, this option has only been tested on linux systems.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Multicast_Interface__INTERFACE"></a>13.5.10.&nbsp;Multicast Interface (INTERFACE)</h4></div></div></div><p><code class="literal"> Option syntax: ... INTERFACE &lt;interfaceName&gt; ... </code> The network interface to use for IP multicast flow transmission can be controlled with this option. The &lt;interfaceName&gt; is the network interface device name to be used for IP multicast transmission for the associated flow. Again, as with <a class="link" href="#">TOS</a> and <a class="link" href="#">TTL</a>, this is generally a "per socket" attribute and care should be taken if it is desired to specify different multicast interfaces for different RAPR flows. This can be accomplished by using different <a class="link" href="#">SRC</a> (source ports) for different RAPR flows. If no INTERFACE option is used, RAPR will behave according to the operating system's default behavior. Example:</p><pre class="programlisting">
#Start an IP multicast flow on Ethernet interface named "eth1"
0.0 DECLARATIVE UDP DST 224.1.2.3/5000 PERIODIC [1.0 256] INTERFACE \
eth1 SRC 5001
</pre></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Reception_Event"></a>13.6.&nbsp;Reception Events</h3></div></div></div><p>For simple reception and logging of unicast traffic, it is generally sufficient just to launch RAPR with the port command line option specifying the port numbers to monitor. However, for IP multicast operation or more complex behavior, a RAPR script with "Reception Events" is required. "Reception Events" in the RAPR script file format include <a class="link" href="#_LISTEN" title="13.6.1.&nbsp;LISTEN">LISTEN</a> types to control which ports are being monitored when; and <a class="link" href="#_JOIN" title="13.6.2.&nbsp;JOIN">JOIN</a> types to dynamically control IP group membership. The RAPR script syntax of "Reception Events" is:</p><pre class="programlisting">
&lt;eventTime&gt; [STOP &lt;stopTime&gt; | DURATION &lt;duration&gt;] &lt;eventType&gt; \
&lt;parameters ...&gt; [&lt;options ...&gt;]
</pre><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_LISTEN"></a>13.6.1.&nbsp;LISTEN</h4></div></div></div><pre class="programlisting">Script syntax:
&lt;eventTime&gt; [STOP &lt;stopTime&gt; | DURATION &lt;duration&gt;] LISTEN &lt;protocol&gt; \
&lt;portList&gt;
</pre><p>The LISTEN event is used to prompt RAPR to begin monitoring one or more ports for received traffic. The &lt;eventTime&gt; denotes the time (in seconds) relative to script execution. The &lt;protocol&gt; field specifies the transport protocol type. Supported protocol types include "UDP" and "TCP" transport. The &lt;portList&gt; field is a comma-delimited list of individual or inclusive ranges of the port numbers (no spaces allowed) to begin monitoring. Port ranges within the list are specified in the format "&lt;lowValue&gt;-&lt;hiValue&gt;". RAPR will IGNORE the listened to port when the timeout interval for the reception event has elapsed. Example:</p><pre class="programlisting">
#Monitor port numbers 5000,5003,5004,5005,5009
#beginning at time 0.0

0.0 LISTEN UDP 5000,5003-5005,5009

</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_JOIN"></a>13.6.2.&nbsp;JOIN</h4></div></div></div><pre class="programlisting">
Script syntax:
&lt;eventTime&gt; [STOP &lt;stopTime&gt; | DURATION &lt;duration&gt;] JOIN &lt;groupAddress&gt; \
[INTERFACE &lt;interfaceName&gt;] [PORT &lt;portNumber&gt;]
</pre><p>The JOIN event is used to prompt RAPR to "join" the specific IP multicast group indicated by the &lt;groupAddress&gt; field. The INTERFACE option forces the membership join request on the network interface identified by the &lt;interfaceName&gt; field. If no INTERFACE option is given, the operating system's default behavior is observed. Note it is possible to join the same group on multiple, different interfaces. Note that a corresponding <a class="link" href="#_LISTEN" title="13.6.1.&nbsp;LISTEN">LISTEN</a> event for the indicated &lt;portNumber&gt; is required in order to receive traffic. Unix-based operating systems generally allow for IP multicast group membership to be independent of specific socket port bindings. RAPR will automatically LEAVE the specific IP multicast group indicated by the &lt;groupAddress&gt; field when the timeout period for the event has elapsed.&gt;/p&gt; As many IP group memberships as the operating system will support is permitted by RAPR. This is generally a limit of the maximum number of open sockets per process or in the system at large if multiple RAPR instances are used. Note that Unix-based systems can allow for many memberships (often 20, but OS-specific) per socket. </p><p> Examples: </p><p> </p><pre class="programlisting">#JOIN group 224.1.2.3 at time 0.0
0.0 JOIN 224.1.2.3

#JOIN group 224.1.2.4 on interface "eth1"
0.0 JOIN 224.1.2.4 INTERFACE eth1

#JOIN group 224.1.2.5 using socket bound to port 5000
0.0 JOIN 224.1.2.5 PORT 5000
</pre></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_Rapr_Events"></a>14.&nbsp;Rapr Events and Global Commands</h2></div></div></div><p>The RAPR script file format supports a subset of commands which are independent of normal transmission and reception event scheduling. They set global parameters for the system (such as setting a default TTL for all outgoing packets) or direct rapr application behavior (such as specifying an absolute script execution start time, changing application state, or loading a dictionary file) . These are referred to as <a class="link" href="#">Rapr Events</a> and <a class="link" href="#_GLOBAL" title="14.2.&nbsp;Global Commands">Global Commands</a>. Global Commands are those that can be specified at the command line upon rapr startup.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_RAPR_EVENT"></a>14.1.&nbsp;RaprEvents</h3></div></div></div><p>The set of "Rapr Events" includes:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="link" href="#_raprpipe" title="14.1.9.&nbsp;RAPRPIPE">RAPRPIPE</a></li><li class="listitem"><a class="link" href="#_stop" title="14.1.10.&nbsp;STOP">STOP</a></li><li class="listitem"><a class="link" href="#_raprflowid" title="14.1.1.&nbsp;RAPRFLOWID">RAPRFLOWID</a></li><li class="listitem"><a class="link" href="#_dictionary_entry" title="14.1.2.&nbsp;DICTIONARY_ENTRY">DICTIONARY_ENTRY</a></li><li class="listitem"><a class="link" href="#_logictable_file" title="14.1.3.&nbsp;LOGICTABLE_FILE">LOGICTABLE_FILE</a></li><li class="listitem"><a class="link" href="#_dictionary_file" title="14.1.4.&nbsp;DICTIONARY_FILE">DICTIONARY_FILE</a></li><li class="listitem"><a class="link" href="#">CHANGE_STATE</a></li><li class="listitem"><a class="link" href="#_change_ubi_state" title="14.1.6.&nbsp;CHANGE_UBI_STATE">CHANGE_UBI_STATE</a></li><li class="listitem"><a class="link" href="#_logicid" title="10.2.&nbsp;<logicid&gt;">LOGICID</a></li><li class="listitem"><a class="link" href="#_input" title="14.1.8.&nbsp;INPUT">INPUT</a></li><li class="listitem"><a class="link" href="#_clear" title="14.1.11.&nbsp;CLEAR">CLEAR</a></li></ul></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_raprflowid"></a>14.1.1.&nbsp;RAPRFLOWID</h4></div></div></div><p><code class="literal"> Script syntax: &lt;eventTime&gt; RAPRFLOWID &lt;raprFlowId&gt; </code> The RAPRFLOWID keyword directs rapr to stop the <a class="link" href="#">behavior event</a> that has been previously associated with the &lt;raprFlowId&gt;. The event will be stopped at the specified start time.</p><pre class="programlisting">5.0 STOP RAPRFLOWID &lt;raprFlowId&gt;

</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_dictionary_entry"></a>14.1.2.&nbsp;DICTIONARY_ENTRY</h4></div></div></div><p><code class="literal"> Script syntax: &lt;eventTime&gt; DICTIONARY_ENTRY &lt;dictionaryName&gt; [&lt;dictionaryValue&gt;] </code> The DICTIONARY_ENTRY keyword directs RAPR to replace the <a class="link" href="#_dictionary" title="11.&nbsp;Dictionary">dictionary</a> entry that has been previously associated with the specified &lt;name&gt; with the provided &lt;value&gt;. The event will take place at the specified start time. The dictionary &lt;value&gt; must be enclosed in brackets.</p><pre class="programlisting">
5.0 DICTIONARY_ENTRY IP [127.0.0.1]
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_logictable_file"></a>14.1.3.&nbsp;LOGICTABLE_FILE</h4></div></div></div><p><code class="literal"> Script syntax: &lt;eventTime&gt; LOGICTABLE_FILE &lt;fileName&gt; </code> The LOGICTABLE_FILE keyword directs RAPR to load the <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a> of the specified &lt;name&gt; at the specified start time. Either a fully qualified path or a relative path name may be specified.</p><pre class="programlisting">
5.0 LOGICTABLE_FILE /home/rapr/logictable.xml
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_dictionary_file"></a>14.1.4.&nbsp;DICTIONARY_FILE</h4></div></div></div><p><code class="literal"> Script syntax: &lt;eventTime&gt; DICTIONARY_FILE /home/rapr/dictionary.xml </code> The DICTIONARY_FILE keyword directs RAPR to load the <a class="link" href="#_dictionary" title="11.&nbsp;Dictionary">dictionary</a> of the specified &lt;name&gt; at the specified start time. Either a fully qualified path or a relative path name may be specified.</p><pre class="programlisting">
5.0 DICTIONARY_FILE &lt;fileName&gt;

</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_CHANGE_STATE"></a>14.1.5.&nbsp;CHANGE_STATE</h4></div></div></div><p><code class="literal"> Script syntax: &lt;eventTime&gt; CHANGE_STATE &lt;state&gt; </code> The CHANGE_STATE keyword directs RAPR to change the state of the applicationto that specified. The state must be defined in the <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table.</a></p><p>Important: To ensure that state changes occur immediately be sure to specify a 0.0 start time for the event. This will guarantee that the event will be enqueued before any other events scheduled to start at the same time.</p><pre class="programlisting">
5.0 CHANGE_STATE 1

</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_change_ubi_state"></a>14.1.6.&nbsp;CHANGE_UBI_STATE</h4></div></div></div><p><code class="literal"> Script syntax: &lt;eventTime&gt; CHANGE_UBI_STATE &lt;ubiState&gt; </code> The CHANGE_UBI_STATE keyword directs RAPR to change the UBI state of the application to that specified. The state must be defined in the <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a>. This command should only be specified in the <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a>. <span class="bold"><strong>Important:</strong></span> To ensure that ubi state changes occur immediately be sure to specify a 0.0 start time for the event. This will guarantee that the event will be enqueued before any other events scheduled to start at the same time.</p><p>Each behavior event is associated with a unique behavior identifier. In the case of interrogative objects, it is transmitted in the payload of outgoing messages. The <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a> can be configured to change the UBI state of history associated with any incoming messages. This feature is designed to handle multiple requests from an originating node that should not result in multiple responses. For example, if an originating node A sends a UDP stream to node B associated with a payload logic id directing node B to perform behavior as specified in the <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a>, node B's table might CHANGE_UBI_STATE so that the response behavior is only activated by the first response. See XXXX for more information on using CHANGE_UBI_STATE. </p><pre class="programlisting"> 
0.0 CHANGE_UBI_STATE 1 1
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_logicid"></a>14.1.7.&nbsp;LOGICID</h4></div></div></div><p><code class="literal"> Script syntax: &lt;eventTime&gt; LOGICID &lt;logicid&gt; </code> The LOGICID keyword directs RAPR to invoke the behavior assoicated with the &lt;logicid&gt; defined in the <a class="link" href="#_behavior_table" title="10.&nbsp;Behavior Event Table">behavior table</a>. Note that the behavior table cannot reference packet specific translations when the LOGICID RAPR event is used.</p><pre class="programlisting">
5.0 LOGICID 1

</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_input"></a>14.1.8.&nbsp;INPUT</h4></div></div></div><p><code class="literal"> Script syntax: &lt;eventTime&gt; INPUT &lt;fileName&gt; </code> The INPUT keyword directs RAPR to load the <a class="link" href="#_input_script" title="12.&nbsp;RAPR Input Script Format">input script</a> of the specified &lt;name&gt; at the specified start time. Either a fully qualified path or a relative path name may be specified. Any events associated with a time will start relative to current RAPR timeline plus event time when the script is parsed. For example, if the current RAPR timeline is 5 minutes into the test, an event scheduled to start at 5.0 in the new input script parsed will start in 5.0 seconds. Any events associated with times prior to the current RAPR timeline will start immediately.</p><pre class="programlisting">
  5.0 INPUT /home/rapr/input.script

</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_raprpipe"></a>14.1.9.&nbsp;RAPRPIPE</h4></div></div></div><p><code class="literal"> Script syntax: RAPRPIPE &lt;pipename&gt; </code> The RAPRPIPE keyword names the run-time control channel that can be used to control the RAPR instance. The run-time control channel is a unix domain datagram socket named /tmp/&lt;raprPipeName&gt; and as such, write access to the /tmp directory is required. Occasionally, an unusual abend condition might cause the socket's /tmp/&lt;raprPipeName&gt; file to remain after the application has terminated and must be deleted before subsequent pipes of the same name can be created.</p><pre class="programlisting">
RAPRPIPE rapr-app

</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_stop"></a>14.1.10.&nbsp;STOP</h4></div></div></div><p><code class="literal"> Script syntax: STOP &lt;hr:min:sec&gt; </code> The STOP keyword directs RAPR to stop the application at the specified absolute stop time.</p><pre class="programlisting">
STOP 17:00:00

</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_clear"></a>14.1.11.&nbsp;CLEAR</h4></div></div></div><p><code class="literal"> Script syntax: [&lt;eventTime&gt;] CLEAR &lt;[ALL | BehaviorEventType | RAPREVENT]&gt; </code> The CLEAR keyword directs RAPR to stop all objects of the specified behavior event type or ALL behavior events if the ALL keyword is specified at the specified event start time. <a class="link" href="#">behavior events</a> and <a class="link" href="#">reception event</a> and <a class="link" href="#">RAPR events</a> can be cleared. All <a class="link" href="#">RAPR</a> events can be cleared with the RAPREVENT keyword. (Note that <a class="link" href="#_GLOBAL" title="14.2.&nbsp;Global Commands">global commands</a> cannot be cleared.</p><pre class="programlisting">
5.0 CLEAR DECLARATIVE
5.0 CLEAR ALL
5.0 CLEAR RAPREVENT
5.0 CLEAR JOIN
5.0 CLEAR CHANGE_UBI_STATE
</pre></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_GLOBAL"></a>14.2.&nbsp;Global Commands</h3></div></div></div><p>In general, a script file should contain only one occurrence of each global command type. If there are multiple occurrences of a command type, the last occurrence will determine RAPR's behavior. These commands can also be given on the RAPR command-line. Global commands given on the RAPR command-line will override any corresponding global commands in the script file(s). The format of script lines containing global commands is: &lt;command&gt; &lt;parameters&gt; The set of RAPREVENTS that are "Global Commands" (meaning they can be specified either in the input script or via the command line) includes:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td><a class="link" href="#hostid">HOSTID</a></td><td>Specifies a HOSTID for the system. NOT RECOMMENDED as a command-line option. See <a class="link" href="#hostid">HOSTID</a> for further details.</td></tr><tr><td><a class="link" href="#_START" title="14.2.3.&nbsp;START">START</a></td><td>Specifies an absolute start time for script processing.</td></tr><tr><td><a class="link" href="#_OFFSET" title="14.2.4.&nbsp;OFFSET">OFFSET</a></td><td>Specifies an offset time into script for RAPR activity.</td></tr><tr><td><a class="link" href="#_TOS" title="14.2.5.&nbsp;TOS">TOS</a></td><td>Specifies a default IPv4 TOS value for IPv4 flows.</td></tr><tr><td><a class="link" href="#_LABEL" title="14.2.6.&nbsp;LABEL">LABEL</a></td><td>Specifies a default IPv6 Flow Label for IPv6 flows.</td></tr><tr><td><a class="link" href="#_TTL" title="14.2.7.&nbsp;TTL">TTL</a></td><td>Specifies a default TTL (time-to-live) hop count for transmitted multicast packets.</td></tr><tr><td><a class="link" href="#_INTERFACE" title="14.2.10.&nbsp;INTERFACE">INTERFACE</a></td><td>Specifies the name of the default interface to use for IP multicast.</td></tr><tr><td><a class="link" href="#_INPUT" title="14.2.11.&nbsp;INPUT">INPUT</a></td><td>Specifies the name of a script file to be loaded and parsed.</td></tr><tr><td><a class="link" href="#_OVERWRITE_RAPRLOG" title="14.2.12.&nbsp;OVERWRITE_RAPRLOG">OVERWRITE_RAPRLOG</a></td><td>Specifies the name of the log file to record logged RAPR events. If the named log file pre-exists, it is overwritten.</td></tr><tr><td><a class="link" href="#_RAPRLOG" title="14.2.14.&nbsp;RAPRLOG">RAPRLOG</a></td><td>Same as OVERWRITE_RAPRLOG, except that pr-existing log files are appended instead of overwritten.</td></tr><tr><td><a class="link" href="#_OVERWRITE_MGENLOG" title="14.2.13.&nbsp;OVERWRITE_MGENLOG">OVERWRITE_MGENLOG</a></td><td>Specifies the name of the log file to record logged mgen events. If the named log file pre-exists, it is overwritten.</td></tr><tr><td><a class="link" href="#_OVERWRITE_MGENLOG" title="14.2.13.&nbsp;OVERWRITE_MGENLOG">OVERWRITE_MGENLOG</a></td><td>Same as OVERWRITE_MGENLOG, except that pr-existing log files are appended instead of overwritten.</td></tr><tr><td><a class="link" href="#_TXBUFFER" title="13.5.8.&nbsp;Socket Transmit Buffer Size (TXBUFFER)">TXBUFFER</a></td><td>Specifies a default socket transmit buffer size.</td></tr><tr><td><a class="link" href="#">RXBUFFER</a></td><td>Specifies a default socket receive buffer size.</td></tr></tbody></table></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_hostid"></a>14.2.1.&nbsp;HOSTID</h4></div></div></div><p><code class="literal">Script syntax: HOSTID &lt;hostId&gt; </code> This command specifies the HOSTID to be used by RAPR. HOSTID is used by the RAPR application to identify it's own network traffic and as such must be unique within a set of interoperating RAPR applications. If no HOSTID is specified the last octet of the host's IP address will be used. For example, given an IP address of 192.168.1.101, "101" will be used as the HOSTID.</p><p>Currently the maximum hostid allowed is 255.</p><p>Although available as a command-line option, it is not recommended to be used this way as it will be overwritten by any subsequent HOSTID definitions in the input script (if specified).</p><p>HOSTID will also be used to seed the system-wide random number generator if no <a class="link" href="#initial_seed">INITIAL_SEED</a> is set and should always be the first entry in the input script such that any subsequent seed assignments are consistent. If an <a class="link" href="#">INITIAL_SEED</a> is specified however, it will be used as the seed.</p><p><span class="emphasis"><em>NOTE: HOSTID must be specified as the first entry (or second entry, if an INITIAL_SEED is also specified) in an input script as subsequent commands may require that random number draws be made. See the <a class="link" href="#">repeatability section</a> for more information on seeding.</em></span></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_hostid"></a>14.2.2.&nbsp;INITIAL_SEED</h4></div></div></div><p><code class="literal"> Script syntax: INITIAL_SEED &lt;seedValue&gt; </code> This command specifies the initial seed value to be used by RAPR to seed its random number generator. It is not recommended to be used as a command line option. RAPR will use the host id if specified or the DEFAULT host id as indicated by the node's local ip address as the initial_seed value if no INITIAL_SEED command is specified. E.g. If no host id or initial seed is specified, given an ip address of 192.168.1.103, "103" will be used as the default INITIAL_SEED value.</p><p><span class="emphasis"><em>NOTE: INITIAL_SEED must be specified as the first entry in an input script as subsequent commands may require that random number draws be made. See the repeatability section for more information on seeding.</em></span></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_START"></a>14.2.3.&nbsp;START</h4></div></div></div><p><code class="literal"> Script syntax: START &lt;hour:min:sec&gt;[GMT] </code> The START command designates an absolute time as indicated by the &lt;hour:min:sec&gt; field to correspond to the relative script time of 0.0 seconds. All transmission and reception events will be scheduled relative to this absolute start time. The optional GMT suffix (no white space after the time) indicates that the clock time given is Greenwich Mean Time (GMT) rather than the operating systems local time zone. If no START command is given, RAPR schedules transmission and reception events relative to program startup. Example:</p><pre class="programlisting">
#Start RAPR exactly at 1:30PM local time
START 13:30:00

#Start RAPR at 30 seconds past 8:30 
GMTSTART 8:30:30GMT

</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_OFFSET"></a>14.2.4.&nbsp;OFFSET</h4></div></div></div><p><code class="literal"> Script syntax: OFFSET &lt;seconds&gt; </code> The OFFSET global command specifies a relative time offset (in seconds)into script processing where RAPR should begin its activity. This allows multiple instances of RAPR using the same script to be dithered as desired. Additionally, this command may be used to immediately restore RAPR to a specific scripted state other than the beginning of the script upon launch. Example:</p><pre class="programlisting">
#Skip the first 10 seconds of an RAPR script
OFFSET 10.0
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_TOS"></a>14.2.5.&nbsp;TOS</h4></div></div></div><p><code class="literal"> Script syntax: TOS &lt;value&gt; </code> The TOS command specifies the type of service to be applied to the messages.</p><pre class="programlisting">
Example:
#Specify default ttl = 0x10 (low delay)
TOS 0x10
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_LABEL"></a>14.2.6.&nbsp;LABEL</h4></div></div></div><p><code class="literal"> Script syntax: LABEL &lt;value&gt; </code> The LABEL command specifies a default value to be used as the "flow label" for IPv6 flows. The "flow label" is the corresponding 28-bit field in the IPv6 packet header. Refer to the Transmission Event <a class="link" href="#">LABEL</a> option for further details.. Example:</p><pre class="programlisting">
#Specify default IPv6 flow label = 0x02500000
LABEL 0x02500000
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_TTL"></a>14.2.7.&nbsp;TTL</h4></div></div></div><p><code class="literal"> Script syntax: TTL &lt;value&gt; </code> The TTL command specifies the default time-to-live (TTL) hop count for generated IP multicast traffic according to the &lt;value&gt; field. The &lt;value&gt; must be in the range of 1-255. If the global TTL command is not used, RAPR assumes a default multicast TTL value of 3. Note that the transmission event TTL option will override the default specification given by this global command. Example:</p><pre class="programlisting">
#Specify default multicast flow ttl = 32
TTL 32
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="TXBUFFER"></a>14.2.8.&nbsp;TXBUFFER</h4></div></div></div><p><code class="literal"> Script syntax: TXBUFFER &lt;txBufferSize&gt; ... </code> This option allows users to set the default socket transmit buffer size to a value &Ograve;at least&Oacute; as large as &lt;txBufferSize&gt;. The exact behavior of this option may be operating system dependent. The TXBUFFER option given on transmission event script lines will override this default for the socket used by the corresponding flow.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="RXBUFFER"></a>14.2.9.&nbsp;RXBUFFER</h4></div></div></div><p><code class="literal"> Script syntax: RXBUFFER &lt;rxBufferSize&gt; ... </code> This option allows users to set the default socket receive buffer size to a value &Ograve;at least&Oacute; as large as &lt;rxBufferSize&gt;. The exact behavior of this option may be operating system dependent. The RXBUFFER option given on transmission event script lines will override this default for the socket used by the corresponding flow.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_INTERFACE"></a>14.2.10.&nbsp;INTERFACE</h4></div></div></div><p><code class="literal"> Script syntax: INTERFACE &lt;interfaceName&gt; </code> The INTERFACE command specifies a default IP network interface to use for multicast traffic generation and group membership. If no INTERFACE command is given, the default operating system behavior is observed. Note that the transmission event INTERFACE option or the JOIN reception event INTERFACE option will override the default specification given by this global command. Example:</p><pre class="programlisting">
#Specify "eth1" as the default network interface 
#for multicast transmission and group joins
INTERFACE eth1
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_INPUT"></a>14.2.11.&nbsp;INPUT</h4></div></div></div><p><code class="literal"> Script syntax: INPUT &lt;scriptFile&gt; </code> The INPUT command cause RAPR to load and parse the given &lt;scriptFile&gt;. (Circular references are not detected by RAPR and should be avoided_). This allows scripts to "include" other scripts. The parsing occurs in the order that the INPUT commands are encountered on the command-line and within the script files themselves. Any events associated with a time will start relative to current RAPR timeline plus event time when the script is parsed. For example, if the current RAPR timeline is 5 minutes into the test, an event scheduled to start at 5.0 in the new input script parsed will start in 5.0 seconds. Any events associated with times prior to the current RAPR timeline will start immediately. Example:</p><pre class="programlisting">
#Load and parse the RAPR script file "script2.mgn"
INPUT script2.mgn
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_OVERWRITE_RAPRLOG"></a>14.2.12.&nbsp;OVERWRITE_RAPRLOG</h4></div></div></div><p><code class="literal"> Script syntax: OVERWRITE_RAPRLOG &lt;logFile&gt; </code> The OVERWRITE_RAPRLOG command cause RAPR to direct its RAPR log output to the indicated &lt;logFile&gt;. The last occurring OVERWRITE_RAPRLOG command determines the log file to be used and the command-line takes precedence over any scripts provided as input to RAPR. The file named by &lt;logFile&gt; will be overwritten if it already exists. Example:</p><pre class="programlisting">
#Use the file "logFile.log" for logging
OVERWRITE_RAPRLOG logFile.log
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_OVERWRITE_MGENLOG"></a>14.2.13.&nbsp;OVERWRITE_MGENLOG</h4></div></div></div><p><code class="literal"> Script syntax: OVERWRITE_MGENLOG &lt;logFile&gt; </code> The OVERWRITE_MGENLOG command cause RAPR to direct its mgen log output to the indicated &lt;logFile&gt;. The last occurring OVERWRITE_MGENLOG command determines the log file to be used and the command-line takes precedence over any scripts provided as input to RAPR. The file named by &lt;logFile&gt; will be overwritten if it already exists. Example:</p><pre class="programlisting">
#Use the file "logFile.log" for logging
OVERWRITE_MGENLOG logFile.log
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_RAPRLOG"></a>14.2.14.&nbsp;RAPRLOG</h4></div></div></div><p><code class="literal"> Script syntax: RAPRLOG &lt;logFile&gt; </code> The RAPRLOG command cause RAPR to direct its RAPR log output to the indicated &lt;logFile&gt;. The last occurring RAPRLOG command determines the log file to be used and the command-line takes precedence over any scripts provided as input to RAPR. The file named by &lt;logFile&gt; will be appended if it already exists. Example:</p><pre class="programlisting">
#Append the file "logFile.log" 
RAPRLOG logFile.log
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="MGENLOG"></a>14.2.15.&nbsp;MGENLOG</h4></div></div></div><p><code class="literal"> Script syntax: MGENLOG &lt;logFile&gt; </code> The MGENLOG command cause RAPR to direct its mgen log output to the indicated &lt;logFile&gt;. The last occurring MGENLOG command determines the log file to be used and the command-line takes precedence over any scripts provided as input to RAPR. The file named by &lt;logFile&gt; will be appended if it already exists. Example:</p><pre class="programlisting">
#Append the file "logFile.log" 
MGENLOG logFile.log
</pre></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_RAPR_Log_File"></a>15.&nbsp;RAPR Log File Format</h2></div></div></div><p>The RAPR log file records details about application behavior and events, for example when a behavior event starts or stops or the time the application started.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="General_RAPR_Log_Format"></a>15.1.&nbsp;General RAPR Log Format</h3></div></div></div><p>Each line of the RAPR text log file corresponds to a unique application event and follows the convention: &lt;eventTime&gt; app&gt;&lt;appType&gt; type&gt;&lt;eventType&gt; action&gt;&lt;actionType&gt; &lt;event attributes ...&gt; The &lt;eventTime&gt; field is in the form hrs:min:sec and represents the computer's system time at the time of the event. The &lt;appType&gt; type will always be RAPR. This field is used to differentiate RAPR events from MGEN events when both events are written to the same output stream. The &lt;eventType&gt; field reflects the application event and is one of the following:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>Application</td><td>Denotes an application specific event.</td></tr><tr><td><a class="link" href="#_Rapr_Events" title="14.&nbsp;Rapr Events and Global Commands">RaprEvent</a></td><td>Indicates a RAPR Event was processed, e.g. loading a logictable, changing application state .</td></tr><tr><td>Error</td><td>Denotes a RAPR error, for example error loading a file.</td></tr><tr><td><a class="link" href="#_declarative" title="13.1.&nbsp;Declarative Event">Declarative</a></td><td>Indicates a declarative event has occurred.</td></tr><tr><td><a class="link" href="#_interrogative" title="13.2.&nbsp;Interrogative Event">Interrogative</a></td><td>Indicates an interrogative event has occurred.</td></tr><tr><td><a class="link" href="#_stream" title="13.3.&nbsp;Stream Event">Stream</a></td><td>Indicates a stream event has occurred.</td></tr><tr><td><a class="link" href="#_periodic" title="13.4.&nbsp;Periodic Event">Periodic</a></td><td>Indicates that a periodic event has occurred.</td></tr><tr><td><a class="link" href="#">ReceptionEvent</a></td><td>Indicates a reception event has occurred.</td></tr></tbody></table></div><p>The &lt;eventAttritbutes&gt; vary depending on the event type. Sample log file entries:</p><pre class="programlisting">
<code class="literal">
20:08:04.534996 app&gt;RAPR type&gt;Application action&gt;ApplicationStartUp
20:08:04.538719 app&gt;RAPR type&gt;RaprEvent action&gt;loading_logictable \
name&gt;../docs/client_logictable.xml
20:08:04.549056 app&gt;RAPR type&gt;Reception action&gt;start ubi&gt;1023410177 \
eventSource&gt;script_event endTime&gt;3600.00 mgenCmd&gt;"LISTEN TCP 5000,"
20:08:04.562810 app&gt;RAPR type&gt;Declarative action&gt;start ubi&gt;1023410178 \
eventSource&gt;script_event payload&gt;1 endTime&gt;0.01 seed&gt;261992998 
payloadSeed&gt;932359081 mgenCmd&gt;"ON 1 TCP SRC 0 DST 192.168.1.102/5000 
PERIODIC [1 409 ] DATA [0204010000000304A9AB9237]"
20:08:04.601751 app&gt;RAPR type&gt;Declarative action&gt;start ubi&gt;1023410180 \
eventSource&gt;net_event payload&gt;2 endTime&gt;0.01 seed&gt;2073794103 \
payloadSeed&gt;1724104380 mgenCmd&gt;"ON 2 TCP SRC 0 DST 192.168.1.102/5000 \
PERIODIC [1 636 ] DATA [0204020000000304BCBEC366]"
20:08:04.616256 app&gt;RAPR type&gt;Declarative action&gt;timeout ubi&gt;1023410178 \
0.001 OFF 1
20:08:04.621802 app&gt;RAPR type&gt;Declarative action&gt;timeout ubi&gt;1023410180 \
0.001 OFF 2
20:08:06.616553 app&gt;RAPR type&gt;Declarative action&gt;start ubi&gt;1023410181 \
eventSource&gt;net_event payload&gt;2 startTime&gt;2.00 endTime&gt;0.01 seed&gt;1913224746 \
payloadSeed&gt;925395647 mgenCmd&gt;"ON 1 TCP SRC 0 DST 192.168.1.102/5000 \
PERIODIC [1 637 ] DATA [0204020000000304BF6A2837]"
20:08:06.616673 app&gt;RAPR type&gt;Declarative action&gt;timeout ubi&gt;1023410181 
0.001 OFF 1
</code>
</pre><p>The DATA field may contain some RAPR specific directives like the triggering behavior event's UBI for interrogative objects, random seed, any payload logic ID, etc. RAPR specific payload content will be displayed in hex values in the log files as:</p><pre class="programlisting">

Example RAPR payload with two fields:
DATA [0204020000000304BF6A2837]

First field: 020402000000
02: Rapr Field type indicator
04: Rapr Field length
02000000: Rapr Field Value

Second Field: 0304BF6A2837
03: Rapr Field type indicator
04: Rapr Field length
BF6A2837: Rapr Field Value
</pre><p>The hex field indicators can be translated as follows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"> 01 RAPR UBI </li><li class="listitem"> 02 RAPR Payload Logic ID </li><li class="listitem"> 03 RAPR Seed </li><li class="listitem"> 04 RAPR Foreign UBI </li><li class="listitem"> 05 RAPR StreamID </li><li class="listitem"> 06 RAPR Stream Sequence Number </li><li class="listitem"> 07 RAPR Stream Duration </li><li class="listitem"> 08 RAPR Stream Burst Count </li><li class="listitem"> 09 RAPR Stream Burst Payload ID </li><li class="listitem"> 0A RAPR Stream Burst Priority </li></ul></div><p>In general, all RAPR messages will contain at least a seed value.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_MGEN_Log_File"></a>16.&nbsp;MGEN Log File Format</h2></div></div></div><p><a name="b5"></a><a name="b7"></a>The MGEN message format contains information to facilitate network performance measurements through post-analysis of MGEN log files. Some of the types of performance statistics which can be determined include:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>Message Throughput</td><td>The time or arrival and size of received messages are logged by MGEN receivers. Network throughput can be assessed with this information.</td></tr><tr><td>Message Delivery Latency</td><td>MGEN messages contain a timestamp reflecting when they were sent and the time of reception is logged by MGEN receivers. Delivery latency statistics (jitter or absolute if clock synchronization (e.g. NTP) is possible) can be determined with this information.</td></tr><tr><td>Message Loss Rate</td><td>MGEN messages are sequence numbered. Message loss can be accounted for via analysis of logged sequence number information.</td></tr><tr><td>Message Re-ordering</td><td>The logged MGEN sequence number information can also be used to determine message re-ordering statistics.</td></tr><tr><td>Multicast JOIN/LEAVE Latency</td><td>The occurrence and time of JOIN/LEAVE events are logged by MGEN receivers. The JOIN latency can be determined by comparing the arrival time of the first message associated with a particular multicast group to the time the group was joined. The LEAVE latency can be determined by comparing the time of the _last_ packet arrival time to the time the receiver left that multicast group (Note that you need a packet sniffing program like <a class="ulink" href="http://www.tcpdump.org/" target="_top">tcpdump</a> to see packets after you leave the group).</td></tr></tbody></table></div><p>Many of the above performance measures and statistics can be measured and optionally graphed using the NRL <a class="ulink" href="http://www.nrl.navy.mil/itd/ncs/products/protean_tools" target="_top">trpr</a> (trace plot real-time) program. This program can parse the MGEN log file format and <a class="ulink" href="http://www.tcpdump.org/" target="_top">tcpdump</a> traces.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="General_Log_Format"></a>16.1.&nbsp;General Log Format</h3></div></div></div><p>Each line of the MGEN text log file format corresponds to a unique event and follows the convention:&lt;eventTime&gt; &lt;eventType&gt; &lt;event attributes ...&gt;The &lt;eventTime&gt; field is in the form hrs:min:sec and represents the computer's system Greenwich Mean Time (GMT) at the time of the event.</p><p>The &lt;eventType&gt; field is one of the following:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td><a class="link" href="#_Log_File_RECV" title="16.2.&nbsp;Log File RECV Events">RECV</a></td><td>Denotes the arrival of a received MGEN message.</td></tr><tr><td><a class="link" href="#_Log_File_RERR" title="16.3.&nbsp;Log File RERR Events">RERR</a></td><td>Indicates an invalid MGEN message was received.</td></tr><tr><td><a class="link" href="#_Log_File_SEND_Events" title="16.4.&nbsp;Log File SEND Events">SEND</a></td><td>Denotes the transmission of an MGEN message.</td></tr><tr><td><a class="link" href="#_Log_File_JOIN" title="16.5.&nbsp;Log File JOIN Events">JOIN</a></td><td>Marks a join to an IP multicast group.</td></tr><tr><td><a class="link" href="#_Log_File_LEAVE" title="16.6.&nbsp;Log File LEAVE Events">LEAVE</a></td><td>Marks the departure from an IP multicast group.</td></tr><tr><td><a class="link" href="#_Log_File_LISTEN" title="16.7.&nbsp;Log File LISTEN Events">LISTEN</a></td><td>Indicates when mgen began monitoring a specific port</td></tr><tr><td><a class="link" href="#_Log_File_IGNORE" title="16.8.&nbsp;Log File IGNORE Events">IGNORE</a></td><td>Indicates when mgen ended monitoring of a specific port</td></tr><tr><td><a class="link" href="#_Log_File_ON" title="16.9.&nbsp;Log File ON Events">ON</a></td><td>Indicates when mgen initiated a TCP connection to the indicated destination ip address and port.</td></tr><tr><td><a class="link" href="#_Log_File_CONNECT" title="16.10.&nbsp;Log File CONNECT Events">CONNECT</a></td><td>Indicates when mgen established a TCP connection from the indicated source ip address and port or to the indicated destination ip address and port.</td></tr><tr><td><a class="link" href="#_Log_File_DISCONNECTED" title="16.11.&nbsp;Log File DISCONNECTED Events">DISCONNECTED</a></td><td>Indicates when an mgen TCP connection was disconnected prior to a scheduled &gt;OFF&lt; event on either the client or server side. This event indicates a TCP error has occurred on the connection.</td></tr><tr><td><a class="link" href="#_Log_File_OFF" title="16.12.&nbsp;Log File OFF Events">OFF</a></td><td>Indicates that an mgen flow was stopped by a scheduled &gt;OFF&lt; event (only available when transmission logging is enabled on the client side)and is logged by both the TCP client and server.</td></tr><tr><td><a class="link" href="#_Log_File_Start_Stop" title="16.13.&nbsp;Log File START and STOP Events">START</a></td><td>Indicates when mgen started processing Transmission and Reception events.</td></tr><tr><td><a class="link" href="#_Log_File_Start_Stop" title="16.13.&nbsp;Log File START and STOP Events">STOP</a></td><td>Indicates when mgen stopped processing Transmission and Reception events.</td></tr></tbody></table></div><p>Different event types will have different event attribute sets. The &lt;event attribute&gt; fields are explicitly labeled so that log file parsing programs can seek specific attributes of interest for given event types.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_RECV"></a>16.2.&nbsp;Log File RECV Events</h3></div></div></div><p>The format of the RECV event log file line is:</p><p><code class="literal">&lt;eventTime&gt; RECV proto&gt;&lt;protocol&gt; flow&gt;&lt;flowId&gt; seq&gt;&lt;sequenceNumber&gt; src&gt;&lt;addr&gt; /&lt;port&gt; dst&gt;&lt;addr&gt;/&lt;port&gt; sent&gt;&lt;txTime&gt; size&gt;&lt;bytes&gt; [host&gt;&lt;addr&gt;/&lt;port&gt;] [gps&gt;&lt;status&gt;,&lt;lat&gt;,&lt;long&gt;,&lt;alt&gt;] [data&gt;&lt;len&gt;:&lt;data&gt;] [flags&gt;&lt;flag&gt;]</code></p><p>The &lt;eventTime&gt; corresponds to when the message was received. The &lt;protocol&gt; specifies the protocol (udp,tcp,sink).The &lt;flowId&gt;, &lt;sequenceNumber&gt;, and &lt;txTime&gt;, are from the payload of the MGEN message. The &lt;txTime&gt; is in the same format as the &lt;eventTime&gt; (i.e. &lt;hr:min:sec&gt; GMT)</p><p>The "dst" &lt;addr&gt;/&lt;port&gt; is from the message payload and corresponds to the destination address to which the source addressed the MGEN message.</p><p>The "src" &lt;addr&gt;/&lt;port&gt; is the source address determined from the corresponding <code class="literal">recvfrom()</code> call for UDP transport or the address to which the TCP connection was made. (An optional "host" address will be embedded in the payload by the MGEN message source and made available as an attribute of the logged RECV event in the future).</p><p>The message "size" in &lt;bytes&gt; is also from the payload, but for UDP transport, should also correspond to the UDP packet payload size. Note that TCP mgen messages can be larger than the maximum UDP message size of 8192 bytes and can be of unlimited size. Therefore, mgen breaks large TCP messages into mgen message "fragments" of a maximum size of 65535 and sets a flag on the mgen message to indicate that it is a TCP message "fragment". Message fragments are flagged with 0x01 to indicate that the message is not complete. The last fragment in a TCP message is flagged 0x02 to indicate "end of message".</p><p>For example, a TCP mgen message of size 66559 will be received and logged by the receiving node as two messages as follows:</p><p>00:33:36.427143 RECV proto&gt;TCP flow&gt;1 seq&gt;1 src&gt;192.168.1.102/35056 dst&gt;192.168.1.100/5000 sent&gt;00:36:11.377105 size&gt;65535 gps&gt;INVALID,999.000000,999.000000,-999 flags&gt;0x01</p><p>00:33:36.427499 RECV proto&gt;TCP flow&gt;1 seq&gt;1 src&gt;192.168.1.102/35056 dst&gt;192.168.1.100/5000 sent&gt;00:36:11.380137 size&gt;1024 gps&gt;INVALID,999.000000,999.000000,-999 flags&gt;0x02</p><p>Also note that a single SEND message will be logged by the transmitting node with a size corresponding to the TCP message size, e.g.:</p><p>00:29:51.396962 SEND proto&gt;TCP flow&gt;1 seq&gt;1 srcPort&gt;0 dst&gt;192.168.1.102/5000 size&gt;66559</p><p>The "host" &lt;addr&gt;/&lt;port&gt; corresponds to the MGEN message source's "perceived" default local address. Note that this may be different from the source address contained in the MGEN log file due to firewalls, Network Address Translation (NAT) devices, multi-homed sources, etc. The accuracy of this information depends upon the source host's configuration with regards to domain name service (DNS), etc. Note this field is optional and may not be present if this information is not valid (The current initial MGEN release does not yet support this option).</p><p>The "src", "dst", and "host" &lt;addr&gt; fields are dotted decimal IPv4 addresses or colon-delimited IPv6 addresses.</p><p>The "flags" field is discussed above.</p><p>The global positioning system (GPS) information is available when the MGEN message source is used in conjunction with the NRL <a class="ulink" href="http://www.nrl.navy.mil/itd/ncs/products/protean_tools" target="_top">gpsLogger</a> program. This program monitors an attached GPS receiver for position information and "publishes" it in shared memory. When mgen is run and detects that it can "subscribe" to GPS position information, it places it in the MGEN message payload. Note that <a class="ulink" href="http://www.nrl.navy.mil/itd/ncs/products/protean_tools" target="_top">gpsLogger</a> can also be used with a pulse-per-second (PPS) capable GPS receiver to provide accurate time synchronization for hosts running the MGEN toolset. This may be useful for mobile network test environments. The MGEN log file "gps" attribute has the following comma-delimited fields:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>&lt;status&gt;</td><td>This indicates the validity of the GPS information and may be either "INVALID", "CURRENT", or "STALE".</td></tr><tr><td>&lt;lat&gt;</td><td>This is the GPS latitude in degrees. A negative value denotes South while a positive value denotes North.</td></tr><tr><td>&lt;long&gt;</td><td>This is the GPS longitude in degrees. A negative value denotes West while a positive value denotes East.</td></tr><tr><td>&lt;alt&gt;</td><td>This is the GPS altitude in meters.</td></tr></tbody></table></div><p>The optional "data" attribute is present only if the received MGEN message contains optional user-defined payload. If present, the &lt;len&gt; indicates the length (in bytes) of the user-defined payload and the &lt;data&gt; following the colon character':' is a hexadecimal representation of the user data where each pair of characters corresponds to one byte of user data. Thus, the number of characters in the &lt;data&gt; field will be 2 * &lt;len&gt;. (The "data" option was supported in MGEN 3.x via the MGEN Payload Manager (mpmgr) tool and is not yet supported in MGEN 4.x. The documentation will be updated when this option is supported).</p><p>Example RECV event log lines:<code class="literal"></code></p><p><code class="literal">22:59:52.312721 RECV proto&gt;&lt;protocol&gt; flow&gt;1 seq&gt;1 src&gt;132.250.68.21/5000 dst&gt;132.259.43.96/5002 sent&gt;22:59:52.310324 size&gt;1024</code></p><p><code class="literal">23:59:53.312721 RECV proto&gt;&lt;protocol&gt; flow&gt;1 seq&gt;2 src&gt;132.250.68.21/5000 dst&gt;132.259.43.96/5002 sent&gt;22:59:52.310324 size&gt;1024 host&gt;132.250.68.21/5000 gps&gt;CURRENT,35.123,79.234,57</code></p><p><code class="literal">23:59:53.312721 RECV proto&gt;&lt;protocol&gt; flow&gt;1 seq&gt;2 src&gt;132.250.68.21/5000 dst&gt;132.259.43.96/5002 sent&gt;22:59:52.310324 size&gt;1024 host&gt;132.250.68.21/5000 gps&gt;CURRENT,35.123,79.234,57 data&gt;10:01a97b34458cff0021e8</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_RERR"></a>16.3.&nbsp;Log File RERR Events</h3></div></div></div><p>The format of the RERR (Receive Error) event log file line is:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; RERR proto&gt;&lt;protocol&gt; type&gt;&lt;errorType&gt; src&gt;&lt;addr&gt;/&lt;port&gt;</code></p><p>The &lt;eventTime&gt; corresponds to when the message in error was received. The &lt;errorType&gt; is one of "none", "version", "checksum", or "dstaddr". An receive error of type "version" indicates the MGEN sender is using an mgen executable with an incompatible version number. The "checksum" error indicates the received message failed checksum validation, and the "dstaddr" error indicates an invalid or unsupported destination address type in the MGEN message received. The &lt;src&gt; attribute indicates the source address of the message in error.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_SEND_Events"></a>16.4.&nbsp;Log File SEND Events</h3></div></div></div><p>The format of the SEND event log file line is:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; SEND proto&gt;&lt;protocol&gt; flow&gt;&lt;flowId&gt; seq&gt;&lt;sequenceNumber&gt; src&gt;&lt;srcPort&gt; dst&gt;&lt;addr&gt;/&lt;port&gt; size&gt;&lt;bytes&gt; [host&gt;&lt;addr&gt;/&lt;port&gt;]</code></p><p>The &lt;eventTime&gt; corresponds to when the message was sent, and it should precisely match the &lt;txTime&gt; logged by the machine the packet is sent to, if the packet is received correctly.</p><p>All the data items are the same as those used in the Log File RECV Events.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_JOIN"></a>16.5.&nbsp;Log File JOIN Events</h3></div></div></div><p>The format of the JOIN log file event line is:</p><p>&lt;eventTime&gt; JOIN group&gt; &lt;groupAddress&gt; [interface&gt; &lt;interfaceName&gt;]</p><p>The &lt;groupAddress&gt; is the IP multicast group address which was joined. The format of this field is either a dotted decimal IPv4 address or a colon-delimited IPv6 address. The &lt;interfaceName&gt; is given only when the executed MGEN script used the INTERFACE option in the corresponding <a class="link" href="#_JOIN" title="13.6.2.&nbsp;JOIN">JOIN</a> script event.</p><p>Example JOIN event log lines:</p><p><code class="literal">22:59:50:234757 JOIN group&gt;224.1.2.3</code></p><p><code class="literal">22:59:51:129574 JOIN group&gt;224.1.2.4 interface&gt;eth1</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_LEAVE"></a>16.6.&nbsp;Log File LEAVE Events</h3></div></div></div><p>The format of log file LEAVE event lines is:</p><p>&lt;eventTime&gt; LEAVE group&gt;&lt;groupAddress&gt; [interface&gt;&lt;interfaceName&gt;]</p><p>The &lt;groupAddress&gt; is the IP multicast group address which was left. The format of this field is either a dotted decimal IPv4 address or a colon-delimited IPv6 address. The &lt;interfaceName&gt; is given only when the executed MGEN script used the INTERFACE option in the corresponding <a class="link" href="#">LEAVE</a> script event.</p><p>Example LEAVE event log lines:<code class="literal"></code></p><p><code class="literal">22:59:59:234757 LEAVE group&gt;224.1.2.3</code></p><p><code class="literal">22:59:59:753683 LEAVE group&gt;224.1.2.4 interface&gt;eth1</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_LISTEN"></a>16.7.&nbsp;Log File LISTEN Events</h3></div></div></div><p>The format of the LISTEN event log file line is:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; LISTEN proto&gt;&lt;protocol&gt; port&gt;&lt;portNumber&gt;</code></p><p>The &lt;protocol&gt; field corresponds to the transport protocol type being used. Supported protocols include "UDP" and "TCP". The &lt;portNumber&gt; field is the host port number to be monitored.</p><p>Example LISTEN event log lines:<code class="literal"></code></p><p><code class="literal">22:59:48:834205 LISTEN proto&gt;UDP port&gt;5000</code></p><p><code class="literal">22:59:49:328039 LISTEN proto&gt;UDP port&gt;5001</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_IGNORE"></a>16.8.&nbsp;Log File IGNORE Events</h3></div></div></div><p>The format of the IGNORE event log file line is:</p><p><code class="literal">&lt;eventTime&gt; IGNORE proto&gt;&lt;protocol&gt; port&gt;&lt;portNumber&gt;</code></p><p>The &lt;protocol&gt; field corresponds to the transport protocol type which was being used. Supported protocols include "UDP" and "TCP". The &lt;portNumber&gt; field is the host port number to be no longer monitored.</p><p>Example IGNORE event log lines:<code class="literal"></code></p><p><code class="literal">23:00:00:723467 IGNORE proto&gt;UDP port&gt;5000</code></p><p><code class="literal">23:01:00:235629 IGNORE proto&gt;UDP port&gt;5001</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_ON"></a>16.9.&nbsp;Log File ON Events</h3></div></div></div><p>The format of the ON event log file line is:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; ON flow&gt;&lt;flowID&gt; dst&gt;&lt;dst&gt;/&lt;portNumber&gt;</code></p><p>This event indicates that mgen has attempted to establish a TCP connection with the target destination address and port. It does not indicate that the connection has been successfully established, only that a connection has been attempted. The &lt;flowID&gt; field corresponds to the TCP flow ID of the connection. The &lt;dst&gt; field corresponds to the destination of the TCP connection. The &lt;portNumber&gt; field is the destination port number of the TCP connection.</p><p>Example ON event log lines:</p><p><code class="literal">23:00:00:723467 ON flow&gt;1 dst&gt;192.168.1.100/5000</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_CONNECT"></a>16.10.&nbsp;Log File CONNECT Events</h3></div></div></div><p>The format of the CONNECT event log file line is:</p><p>&lt;eventTime&gt; CONNECT src&gt;&lt;src&gt;/&lt;portNumber&gt;</p><p>&lt;eventTime&gt; CONNECT flow&gt;&lt;flowId&gt; dst&gt;&lt;dst&gt;/&lt;portNumber&gt;</p><p>The &lt;src&gt; and &lt;dst&gt; fields correspond to the source or destination ip address of the TCP connection. The &lt;src&gt; and &lt;dst&gt; &lt;portNumber&gt; field is the source or destination port number of the TCP connection. The &lt;flowID&gt; is only available for client-side (originator) events.</p><p>Example CONNECT event log line (server):</p><p>23:00:00:723467 CONNECT src&gt;192.168.1.100/34730</p><p>Example CONNECT event log line (client):<code class="literal"></code></p><p><code class="literal">23:00:00:723467 CONNECT flow&gt;1 dst&gt;192.168.1.102/5000</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_DISCONNECTED"></a>16.11.&nbsp;Log File DISCONNECTED Events</h3></div></div></div><p>The format of the DISCONNECTED event log file line is:</p><p>&lt;eventTime&gt; DISCONNECTED flow&gt;&lt;flowID&gt; src&gt;&lt;src&gt;/&lt;portNumber&gt; status&gt;&lt;status&gt;</p><p>This event indicates that a TCP connection with the indicated address and port has disconnected either because the connection could not be established in the first place or because the connection was prematurely terminated. In the TCP client's log file, the dst address and port reflect the address and port of the node the client was attempting to connect to. In the TCP server's log file, the src address and port reflects the address and port of the connecting node. The &lt;flowID&gt; field corresponds to the TCP flow ID of the connection (this field is only available in the client's event log). Note that if a TCP connection was not prematurely terminated, no DISCONNECTED event will be logged.</p><p>Example Client DISCONNECTED event log line (client):<code class="literal"></code></p><p><code class="literal">23:00:00:723467 DISCONNECTED flow&gt;1 dst&gt;192.168.1.102/5000</code></p><p>Example Server DISCONNECTED event log line (server):<code class="literal"></code></p><p><code class="literal">23:00:00:723467 DISCONNECTED src&gt;192.168.1.100/32423</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_OFF"></a>16.12.&nbsp;Log File OFF Events</h3></div></div></div><p>The format of the OFF event log file line is:</p><p>&lt;eventTime&gt; OFF [flow&gt; &lt;flowID&gt;] [src&gt;&lt;src&gt;|dst&gt;&lt;dst&gt;]/&lt;portNumber&gt;</p><p>This event indicates that a TCP connection with the indicated address and port has been disconnected as scheduled as planned by an mgen OFF event or because the flow sent the required <a class="link" href="#">COUNT</a> of packets. In the TCP client's log file, the dst address and port reflect the address and port of the node the client was connected to. In the TCP server's log file, the src address and port reflects the address and port of the connecting node. The &lt;flowID&gt; field corresponds to the TCP flow ID of the connection (this field is only available in the client's event log). Note that if a TCP connection was prematurely terminated by either the client or the server, no OFF event will be logged.</p><p>Example Client OFF event log line (client):<code class="literal"></code></p><p><code class="literal">23:00:00:723467 OFF flow&gt;1 dst&gt;192.168.1.102/5000</code></p><p>Example Server OFF event log line (server):<code class="literal"></code></p><p><code class="literal">23:00:00:723467 OFF src&gt;192.168.1.100/32423</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_Start_Stop"></a>16.13.&nbsp;Log File START and STOP Events</h3></div></div></div><p>The format of the START and STOP event log file line is:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; START</code>or<code class="literal">&lt;eventTime&gt;STOP</code></p><p>These log file lines indicate the time at which MGEN began and ended its operation. The "START" time corresponds to the relative time zero for any executed scripts. This "START" time is when the mgen program was executed unless the global <a class="link" href="#_START" title="14.2.3.&nbsp;START">START</a> command was invoked. The "STOP" command corresponds to when the mgen program was halted.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_Binary"></a>17.&nbsp;Binary Log File Format</h2></div></div></div><p>At the beginning of binary log files, there is a plain text line to make it easy to tell what kind of file it is. It has the RAPR version number, as well as the type of file ("binary_log"). This line is terminated with a line feed and a NULL ('\0') character. Following the NULL, the file contains a series of binary formatted records. There are several different types of records in the binary log file format. Each record consists of a number of fields. The first single-byte field indicates the record type. A record type of 0 is considered invalid. All multiple-byte fields are in standard network byte order (i.e. most significant byte first). Each record in the binary log file corresponds to a single unique RAPR event, just as each line in the text-based log file does. Each binary log file record contains the same information that every line of the text-format log file has. The text-format log file can actually be recreated from a binary log file using the "convert" command of RAPR.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Binary_Log_File_RECV_Events"></a>17.1.&nbsp;Binary Log File RECV Events</h3></div></div></div><pre class="programlisting">

The format of the RECV event binary log file record is:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    type = 1   |   reserved    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       eventTimeSeconds                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     eventTimeMicroseconds                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            srcPort            |  srcAddrType  |  srcAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          srcAddr ...                          |
                                                                 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          messageSize          |    version    |    flags      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          RAPRFlowId                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        sequenceNumber                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         txTimeSeconds                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       txTimeMicroseconds                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            dstPort            |  dstAddrType  |  dstAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          dstAddr ...                          |
                                                                 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           hostPort            | hostAddrType  | hostAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         hostAddr ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            latitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           longitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            altitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   gpsStatus   |  reserved   |           payloadLen            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          payload ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre><p>The &lt;type&gt; field contains the record type. The record type for RECV events is 1. For backwards compatibility, unknown record types are skipped by the binary to text log file conversion function. The &lt;reserved&gt; field is unused at this time and is set to 0. The &lt;eventRecordLength&gt; field contains the length of this record, starting with the next byte. Thus, it contains the length of the entire record, less what will have already been read when this two-byte number is obtained. The &lt;srcPort&gt; field contains the port number that the message was sent from. The &lt;srcAddrType&gt; field indicates the type of the source. Possible types and values include:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>INVALID_ADDRESS</td><td>0</td></tr><tr><td>IPv4</td><td>1</td></tr><tr><td>IPv6</td><td>2</td></tr></tbody></table></div><p>The &lt;srcAddrLen&gt; field indicates the length in bytes of source address field &lt;srcAddr&gt; to follow. The length should be 0 (zero) for the INVALID_ADDRESS type, 4 for IPv4 addresses, and 16 for IPv6 addresses. The &lt;srcAddr&gt; contains the address to which the RAPR message was sent from. The address is in network byte order. The rest of the packet is just a copy of the message payload from the original packet. For details on these fields, please look <a class="link" href="#">here</a>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Binary_Log_File_RERR_Event"></a>17.2.&nbsp;Binary Log File RERR Events</h3></div></div></div><p>The format of the RERR (receive error) event binary log file record is:</p><pre class="programlisting">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    type = 1   |   reserved    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       eventTimeSeconds                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     eventTimeMicroseconds                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            srcPort            |  srcAddrType  |  srcAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          srcAddr ...                          |
                                                                 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          errorType|                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><p>The &lt;type&gt; field contains the record type. The record type for RECV events is 1. For backwards compatibility, unknown record types are skipped by the binary to text log file conversion function. The &lt;reserved&gt; field is unused at this time and is set to 0. The &lt;eventRecordLength&gt; field contains the length of this record, starting with the next byte. Thus, it contains the length of the entire record, less what will have already been read when this two-byte number is obtained. The &lt;srcPort&gt; field contains the port number that the message was sent from. The &lt;srcAddrType&gt; field indicates the type of the source. Possible types and values include:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>INVALID_ADDRESS</td><td>0</td></tr><tr><td>IPv4</td><td>1</td></tr><tr><td>IPv6</td><td>2</td></tr></tbody></table></div><p>The &lt;srcAddrLen&gt; field indicates the length in bytes of source address field &lt;srcAddr&gt; to follow. The length should be 0 (zero) for the INVALID_ADDRESS type, 4 for IPv4 addresses, and 16 for IPv6 addresses. The &lt;srcAddr&gt; contains the address to which the RAPR message was sent from. The address is in network byte order. The &lt;errorType&gt; indicates the type of message error detected and is one of the following possible error type values:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>No error</td><td>0</td></tr><tr><td>Version number mismatch</td><td>1</td></tr><tr><td>Checksum validation failure</td><td>2</td></tr><tr><td>Message length error</td><td>3</td></tr><tr><td>Destination address invalid</td><td>4</td></tr></tbody></table></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Binary_Log_File_SEND_Events"></a>17.3.&nbsp;Binary Log File SEND Events</h3></div></div></div><p>SEND events are only logged if transmit logging has been turned on with the txlog option. The format of the SEND event binary log file record is:</p><pre class="programlisting">
0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    type = 2   |   reserved    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          messageSize          |    version    |    flags      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          RAPRFlowId                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        sequenceNumber                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         txTimeSeconds                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       txTimeMicroseconds                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            dstPort            |  dstAddrType  |  dstAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          dstAddr ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           hostPort            | hostAddrType  | hostAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         hostAddr ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><p>These fields are the same ones that are used in the <a class="link" href="#">RECV</a> events. The &lt;type&gt; for SEND events is 2. Immediately following the &lt;eventRecordLength&gt; is a copy of the original message payload, without the GPS data and payload. The event time is left out, since it is the same as the transmit time.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Binary_Log_File_LISTEN_IGNORE_Events"></a>17.4.&nbsp;Binary Log File LISTEN/IGNORE Events</h3></div></div></div><p>LISTEN and IGNORE events both have the same format:</p><pre class="programlisting">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  type = 3/4   |   reserved    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       eventTimeSeconds                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     eventTimeMicroseconds                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   protocol    |   reserved    |          portNumber           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><p>LISTEN events have a &lt;type&gt; of 3, while IGNORE events have a &lt;type&gt; of 4. The &lt;protocol&gt; field contains the transport protocol type to LISTEN for, while the &lt;portNumber&gt; field tells us what port number to LISTEN on. Possible types and values for the &lt;protocol&gt; include:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>INVALID_PROTOCOL</td><td>0</td></tr><tr><td>UDP</td><td>1</td></tr><tr><td>TCP (unsupported)</td><td>2</td></tr></tbody></table></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Binary_Log_File_JOIN_LEAVE_Events"></a>17.5.&nbsp;Binary Log File JOIN/LEAVE Events</h3></div></div></div><p>JOIN and LEAVE events also have an identical format:</p><pre class="programlisting">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  type = 5/6   |   reserved    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       eventTimeSeconds                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     eventTimeMicroseconds                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           groupPort           | groupAddrType | groupAddrLen  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         groupAddr ...                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| ifaceNameLen  |             asciiInterfaceName ...            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     asciiInterfaceName ...                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><p>JOIN events are of &lt;type&gt; 5, and LEAVE events have a &lt;type&gt; of 6. The &lt;groupPort&gt; is the port which will be used to JOIN/LEAVE the group. The &lt;groupAddrType&gt;, &lt;groupAddrLen&gt;, and &lt;groupAddr&gt; are the type, length, and raw value of the group address, similar to those of addresses in other record types. The ifaceNameLen field contains the length in bytes of the &lt;asciiInterfaceName&gt; that follows it.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Binary_Log_File_START_STOP_Events"></a>17.6.&nbsp;Binary Log File START/STOP Events</h3></div></div></div><p>START and STOP events both have the same format:</p><pre class="programlisting">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  type = 7/8   |   reserved    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       eventTimeSeconds                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     eventTimeMicroseconds                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><p>START events have a &lt;type&gt; 7, while STOP events are of &lt;type&gt; 8. They contain only the time the event occurred.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_RAPR_Message_Payload_"></a>18.&nbsp;RAPR Message Payload</h2></div></div></div> The RAPR message payload format is given below. Note that the Version 4.1 message format is slightly different than that of RAPR Version 4.0. The RAPR message payload is in the following format: <pre class="programlisting">
 0                   1                   2                   3 
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          messageSize          |    version    |    flags      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          RAPRFlowId                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        sequenceNumber                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         txTimeSeconds                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       txTimeMicroseconds                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            dstPort            |  dstAddrType  |  dstAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          dstAddr ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           hostPort            | hostAddrType  | hostAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         hostAddr ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            latitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           longitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            altitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   gpsStatus   |  reserved   |           payloadLen            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          payload ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           padding                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          checksum                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre> All multiple-byte fields are in standard network byte order (i.e. most significant byte first). The &lt;messageSize&gt; field indicates the total size (including the &lt;messageSize&gt;, &lt;version&gt;, &lt;flags&gt;, etc fields) of the RAPR message in bytes. The current UDP-only transport limits this to a maximum of 8192 bytes. In the future, larger message sizes will be supported and in conjunction with the &lt;flags&gt; field, very large messages will be supported as a concatenation of RAPR messages to support emulation of large file transfers, etc. <p>The &lt;version&gt; field is the RAPR message protocol version number. This will enable future versions of RAPR to b backwards compatible and prevent older versions of RAPR from attempting to parse packets in unknown format. Currently a single &lt;flags&gt; value (CHECKSUM = 0x01) is defined. When this flag is set, it indicates the presence of the &lt;checksum&gt; field at the end of the RAPR message. It is expected that additional flags will be useful as RAPR adds support for transport types besides UDP.</p><p>The &lt;RAPRFlowId&gt; contains the flow/thread identification value associated with the RAPR flow in the corresponding script which created the flow. Note that each flow identified from an RAPR source has its own sequence number space.</p><p>The &lt;sequenceNumber&gt; contains the 32-bit sequence number which is incremented with each message generated for an RAPR flow. This will wrap to zero when the maximum is reached.</p><p>The &lt;txTimeSeconds&gt; and &lt;txTimeMicroseconds&gt; fields are used to mark the time of transmission of the RAPR message. The time is the source computer's system time in Greenwich Mean Time (GMT).</p><p>The &lt;dstPort&gt; is the destination port number to which the RAPR message addressed by the source. The &lt;dstAddrType&gt; field indicates the type of destination address encapsulated in following fields. Possible types and values include:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>INVALID_ADDRESS</td><td>0</td></tr><tr><td>IPv4</td><td>1</td></tr><tr><td>IPv6</td><td>2</td></tr></tbody></table></div> The &lt;dstAddrLen&gt; field indicates the length in bytes of the destination address field &lt;dstAddr&gt; to follow. The length should be 0 (zero) for the INVALID_ADDRESS type, 4 for IPv4 addresses, and 16 f or IPv6 addresses. <p>The &lt;dstAddr&gt; contains the destination address to which the source addressed the RAPR message. The address is in network byte order. Note that the following fields are optional and the RAPR message length my be truncated at any point after here. Any incomplete optional fields are considered invalid.</p><p>The &lt;hostPort&gt; and &lt;hostAddr&gt; (if present and valid) contain the RAPR message source's default local address. Note that this may be different from the source address contained in the RAPR log file due to firewalls, Network Address Translation (NAT) devices, multi-homed sources, etc.</p><p>The &lt;hostPort&gt; is the destination port number to which the RAPR message was addressed by the source. The &lt;hostAddrType&gt; field indicates the type of destination address encapsulated in following fields. The possible values are the same as for the &lt;dstAddrType&gt; described above. The &lt;hostAddrLen&gt; field indicates the length in bytes of the destination address field &lt;hostAddr&gt; to follow. The &lt;hostAddr&gt; contains the source's perception of its local default network address. In RAPR, this is determined by a system call to gethostname(), followed by a call to name resolution. This address may be incorrect if the host is not correctly configured or domain name service (DNS) is unavailable.</p><p>The &lt;latitude&gt;, &lt;longitude&gt;, and &lt;altitude&gt; fields contain values corresponding to GPS information for the RAPR source if it was available. The &lt;latitude&gt; and &lt;longitude&gt; fields are encoded as follows: &lt;fieldValue&gt; = (unsigned long)((&lt;actualValue&gt;+180.0)*60000.0) The &lt;altitude&gt; field is the direct representation of the altitude value available from the source's GPS system. The &lt;gpsStatus&gt; indicates the validity of the GPS information which was encoded. Possible status types and values currently include:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>INVALID_GPS</td><td>0</td></tr><tr><td>STALE</td><td>1</td></tr><tr><td>CURRENT</td><td>2</td></tr></tbody></table></div><p>In addition to the &lt;gpsStatus&gt; field, actual values of 999.0 for latitude and longitude, and &ETH;999 for altitude also correspond to invalid values. The &lt;payloadLen&gt; field, when of non-zero value, indicates the presence of optional user-defined content in the RAPR message. The &lt;payloadLen&gt; value indicates the quantity (in bytes) of user-defined content which follows. The &lt;payload&gt; field may contain some RAPR specific directives like the triggering behavior event's UBI for interrogative objects, random seed, any payload logic ID, etc. RAPR specific payload content will be displayed in hex avlues in the log files as:</p><pre class="programlisting">
Example RAPR payload with two fields:
DATA [0204020000000304BF6A2837]

First field: 020402000000
02: Rapr Field type indicator
04: Rapr Field length
02000000: Rapr Field Value

Second Field: 0304BF6A2837
03: Rapr Field type indicator
04: Rapr Field length
BF6A2837: Rapr Field Value
</pre><p>The hex field indicators can be translated as follows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">01 RAPR UBI</li><li class="listitem">02 RAPR Payload Logic ID</li><li class="listitem">03 RAPR Seed</li><li class="listitem">04 RAPR Foriegn UBI</li><li class="listitem">05 RAPR StreamID</li><li class="listitem">06 RAPR Stream Sequence Number</li><li class="listitem">07 RAPR Stream Duration</li><li class="listitem">08 RAPR Stream Burst Count</li><li class="listitem">09 RAPR Stream Burst Payload ID</li><li class="listitem">0A RAPR Stream Burst Priority</li></ul></div><p>In general, all RAPR messages will contain at least a seed value. The &lt;payload&gt; field also may contain user-defined content and is of length &lt;payloadLen&gt; bytes. Note that a short RAPR &lt;messageSize&gt; could truncate this field. If the RAPR user provides the optional user-defined content, it is up to the user to ensure that the generated RAPR messages are of sufficient size as not to truncate the &lt;payload&gt; content. The &lt;padding&gt; portion of RAPR messages contain undefined data content.</p><p>The &lt;checksum&gt; field is optional and is present when the CHECKSUM (0x01) flag is set in the &lt;flags&gt; field. Note that corrupted messages may result in RAPR messages with the &lt;flags&gt; field itself corrupted, so it may be useful for RAPR implementations to have an option to validate checksums even when the CHECKSUM flag is not set if it is known that the sender is providing checksum content.</p><p>Note: The total size of the RAPR message is defined by the &lt;messageSize&gt; field. The optional fields may be truncated if the &lt;messageSize&gt; is small. The minimum RAPR message size will depend upon the IP address types being used. For example, the minimum allowed RAPR message size using IPv4 addresses with no optional fields is 28 bytes (i.e. for UDP, the UDP payload size would be 28 bytes). If GPS information is to be included without truncation, the minimum message size becomes 52 bytes with the inclusion of the &lt;hostAddr&gt; and GPS information. For IPv6 destination addresses, the minimum allowed RAPR message size is 40 bytes with no optional fields. If GPS information is included the minimum message size with truncating information is 76 bytes.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3019"></a>19.&nbsp;Known Bugs and Issues</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3022"></a>19.1.&nbsp;Offset and the Periodic Object</h3></div></div></div><p>Using the OFFSET command with the PERIODIC object may interfere with the repeatability of the object's behavior during multiple scenario runs if the offset start time overlaps with the duration of the periodic object. Periodic objects that complete or begin before or after the offset time will not be affected. When the periods overlap, the seeding of spawned behavior events will not be correct, and therefore repeatable.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3027"></a>19.2.&nbsp;POISSON (Exponential) MGEN Patterns and Repeatability</h3></div></div></div><p>Currently MGEN does not use a parallel random number generator and therefore MGEN patterns that make random number draws (e.g. the POISSON pattern, the EXP pattern, etc.) will not be repeatable.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3032"></a>19.3.&nbsp;RAPR and SMF</h3></div></div></div><p>In environments where UDP packet duplication is possible (such as when running SMF) care should be taken when triggering logic behavior.  For example, each Declarative message will trigger a behavior response and as such duplicated packets will trigger duplicate behaviors..  In general in such environments, triggering behavior should be restricted to interrogative TCP messages.</p><p>Note also that Stream Behavior Events cannot be reliably used in highly volatile mobile environments as loss of a network connectivity with a single participant may end the behavior.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3039"></a>19.4.&nbsp;Path Specification </h3></div></div></div><p>Paths must be fully qualified in RAPR at present.  (e.g. relative paths not supported).  Some techniques desribed in the best practices section may help address this limitation.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3044"></a>19.5.&nbsp;Stream Behavior Events and Network Volatility</h3></div></div></div><p>Stream behavior events do not perform well in environments with high network volatility as loss of a single participant may end the behavior.  Note that network lossiness is tolerated as a single message in a stream is all that is required to continute the "interaction".</p></div></div></div></body></html>